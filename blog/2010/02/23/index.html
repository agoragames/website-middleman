<!DOCTYPE html> <html class=no-js lang=en> <head> <meta charset=utf-8> <meta content='width=device-width, initial-scale=1.0' name=viewport> <meta content='IE=edge,chrome=1' http-equiv=X-UA-Compatible> <title>Brain Matters</title> <link href="/assets/stylesheets/app-0c494247.css" rel=stylesheet /> <script src="/assets/javascripts/modernizr-84a49412.js"></script> <link href='/assets/images/favicon.ico' rel='shortcut icon'> </head> <body class='blog blog_2010 blog_2010_02 blog_2010_02_23 blog_2010_02_23_index f-topbar-fixed'> <div class='fixed raised'> <nav class=top-bar data-topbar role=navigation> <ul class=title-area> <li class=name> <h1> <a href='/'> <img alt="Agora Games" class=main-logo src="/assets/images/agoragames-new-8534f601.svg"/> </a> </h1> </li> <li class='toggle-topbar menu-icon'> <a href='javascript:void(0)'> <span>Menu</span> </a> </li> </ul> <section class=top-bar-section> <ul class=right> <li> <a data-anchor href='/#about'>About</a> </li> <li> <a data-anchor href='/#team'>Team</a> </li> <li> <a data-anchor href='/#contact'>Contact</a> </li> <li> <a href='/careers'>Careers</a> </li> <li> <a href='/blog'>Blog</a> </li> <li class=hydra-theme> <a href='http://hydra.agoragames.com'> <img alt=Hydra width=92 src="/assets/images/hydra-wordmark-6248cf07.svg"/> </a> </li> </ul> </section> </nav> </div> <div class=row> <div class=columns> <h1 class=blog-page-title> <a href="/blog">The <strong>Blog</strong> </a></h1> </div> </div> <div class=row> <div class='columns large-9'> <div class=blog-page-subtitle> <h2>Posts from February 23, 2010 </h2> </div> <div class=blog-entry-list><div class=blog-entry> <div class=blog__date> Feb 23 </div> <div class=blog__contents> <h2 class=blog__title> <a href="/blog/2010/02/23/experimenting-with-redis/">Experimenting with Redis</a> </h2> <div class=blog__author> By <strong>David Czarnecki</strong> </div> <div class=blog__body> <p>Yesterday I started looking at ways to do inter-application communication. In a number of projects we&rsquo;ve done here at Agora Games, we&rsquo;ve used queues to make that happen. <a href="http://code.google.com/p/redis/">Redis</a> has been on my radar for awhile now, but yesterday I drove my Chevy to the levee and guess what? The levee is NOT dry people. I mean, who drinks rye anyway these days? Old people.</p> <p>Right, <a href="http://code.google.com/p/redis/">Redis</a>.</p> <p>&ldquo;Redis is an advanced key-value store. It is similar to memcached but the dataset is not volatile, and values can be strings, exactly like in memcached, but also lists, sets, and ordered sets. All this data types can be manipulated with atomic operations to push/pop elements, add/remove elements, perform server side union, intersection, difference between sets, and so forth. Redis supports different kind of sorting abilities.&rdquo;</p> <p>I was particularly interested in the support in Redis for lists, which would allow me to have one application push stuff into the datastore and allow for another application to pull stuff from the datastore. A datastore that could operate as a queue? I guess this is as close as we&rsquo;re going to get to flying cars in 2010. Redis is also supposed to be wicked fast and there are a number of libraries available in your programming language of choice with which to communicate with Redis.</p> <p>Redis setup was trivial and &ldquo;just worked&rdquo;.</p> <p>After starting the Redis server, I could just prototype in script/console.</p> <p>Here we go:</p> <pre class="highlight ruby"><code><span class="o">&gt;&gt;</span> <span class="n">redis_queue</span> <span class="o">=</span> <span class="no">Redis</span><span class="p">.</span><span class="nf">new</span>
<span class="o">=&gt;</span> <span class="c1">#&lt;Redis:0x222df9c @thread_safe=nil, @logger=nil, @password=nil, @timeout=5, @db=0, @sock=nil, @host="127.0.0.1", @port=6379&gt;</span>
<span class="o">&gt;&gt;</span> <span class="n">redis_queue</span><span class="p">.</span><span class="nf">push_tail</span> <span class="s1">'strings'</span><span class="p">,</span> <span class="s1">'string 1'</span>
<span class="o">=&gt;</span> <span class="s2">"OK"</span>
<span class="o">&gt;&gt;</span> <span class="n">redis_queue</span><span class="p">.</span><span class="nf">push_tail</span> <span class="s1">'strings'</span><span class="p">,</span> <span class="s1">'string 2'</span>
<span class="o">&gt;&gt;</span> <span class="s2">"OK"</span>
<span class="o">&gt;&gt;</span> <span class="n">redis_queue</span><span class="p">.</span><span class="nf">list_length</span><span class="p">(</span><span class="s1">'strings'</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="mi">2</span>
<span class="o">&gt;&gt;</span> <span class="n">redis_queue</span><span class="p">.</span><span class="nf">list_range</span><span class="p">(</span><span class="s1">'strings'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"string 1"</span><span class="p">,</span> <span class="s2">"string 2"</span><span class="p">]</span>
<span class="o">&gt;&gt;</span> <span class="n">some_string</span> <span class="o">=</span> <span class="n">redis_queue</span><span class="p">.</span><span class="nf">pop_head</span><span class="p">(</span><span class="s1">'strings'</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="s2">"string 1"</span>
<span class="o">&gt;&gt;</span> <span class="n">r</span><span class="p">.</span><span class="nf">list_range</span><span class="p">(</span><span class="s1">'strings'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="p">[</span><span class="s2">"string 2"</span><span class="p">]</span>
<span class="o">&gt;&gt;</span> <span class="n">r</span><span class="p">.</span><span class="nf">list_length</span><span class="p">(</span><span class="s1">'strings'</span><span class="p">)</span>
<span class="o">=&gt;</span> <span class="mi">1</span>
<span class="o">&gt;&gt;</span> <span class="n">quit</span>
</code></pre> <p><a href="http://code.google.com/p/redis/wiki/CommandReference">There are quite a few commands that make Redis even more awesome, but for now I&rsquo;m sold</a>. (If using an entire sentence as a link is wrong then I don&rsquo;t want to be right)</p> <p>Also, I know of <a href="http://github.com/defunkt/resque#readme">Resque</a>, &ldquo;a Redis-backed library for creating background jobs, placing those jobs on multiple queues, and processing them later.&rdquo; If I ever feel like driving the Mercedes Benz of flying cars, I&rsquo;ll use it.</p> </div> </div> </div> <div class=blog-entry> <div class=blog__date> Feb 23 </div> <div class=blog__contents> <h2 class=blog__title> <a href="/blog/2010/02/23/watching-trees/">Watching Trees</a> </h2> <div class=blog__author> By <strong>Jason LaPorte</strong> </div> <div class=blog__body> <p>As a SysAdmin, my job more-or-less exists by knowing miscellaneous arcana that most software engineers aren&rsquo;t aware of.</p> <p>When a particular co-worker here at Agora has a problem with his Linux machine, I provide advice and show him how to fix it. Some months after he had joined Agora, I discovered that after each troubleshooting session, he copy-and-pastes the entire text terminal log into a text file that he keeps on his desktop. He has dozens of transcripts at this point; I bet if I were to look through it, it would read something like the Tao te Ching or Bhagavad Gita, only concerning UNIX instead of right living.</p> <p>(Of course, there&rsquo;s not much of a difference between UNIX and right living, but that&rsquo;s a topic for another day.)</p> <p>In the spirit of allowing you to build your own little collection, here is a simple trick that came in handy to me yesterday.</p> <p>Last night, the cron jobs powering one of our managed sites stopped running. I had stopped them, cleaned up, and restarted them, but I wanted to watch the system and see if they had started running again so I could monitor that they were doing their job.</p> <p>UNIX has a well-known command called &ldquo; <a href="http://linux.die.net/man/1/top">top</a>,&rdquo; which shows superlative processes running on your system: which ones are consuming the most CPU time, which ones are consuming the most RAM, which ones have been running the longest, and so on. It&rsquo;s a very useful tool, but if you&rsquo;re trying to track down processes over time that don&rsquo;t necessarily consume very many resources, then it&rsquo;s not the tool you&rsquo;re looking for.</p> <p>However, our Linux distribution (and, indeed, most others) provide a useful graphical tool for mapping the current state of the system: &ldquo; <a href="http://linux.die.net/man/1/pstree">pstree</a>.&rdquo; This command will give you a list of processes (much like the &ldquo; <a href="http://linux.die.net/man/1/ps">ps</a>&rdquo; command), except that instead of generating a list, it will draw a little tree showing the state of the system. This is perfect for seeing exactly what is going on: which daemons are running, who is on the system and what they&rsquo;re executing, and so on. However, it doesn&rsquo;t show you what is happening over time; it merely lists what is happening at this moment.</p> <p>However, our Linux distribution (and, indeed, most others) provides yet another useful tool: &ldquo; <a href="http://linux.die.net/man/1/watch">watch</a>.&rdquo; It runs a program every 2 seconds (by default) and displays the result to your screen. This allows you to make a ghetto clock by writing something like &ldquo;watch <a href="http://linux.die.net/man/1/date">date</a>;&rdquo; in our case, we could make a ghetto graphical &ldquo;top&rdquo; by writing the simple &ldquo;watch pstree.&rdquo; You can now watch your virtual trees rustle in the wind.</p> <p>It kept us on top of the cron job, and things were back to normal in no time.</p> <p>For more information, RTFM. :)</p> </div> </div> </div> </div> </div> <div class='columns large-3'> <div class=blog-archives-sidebar> <h2>Blog archives</h2> <h3> <a href="/blog/2015/">2015</a> </h3> <ul> <li> <a href="/blog/2015/10/">October 2015</a> </li> <li> <a href="/blog/2015/03/">March 2015</a> </li> <li> <a href="/blog/2015/01/">January 2015</a> </li> </ul> <h3> <a href="/blog/2014/">2014</a> </h3> <ul> <li> <a href="/blog/2014/12/">December 2014</a> </li> <li> <a href="/blog/2014/11/">November 2014</a> </li> <li> <a href="/blog/2014/10/">October 2014</a> </li> <li> <a href="/blog/2014/08/">August 2014</a> </li> <li> <a href="/blog/2014/07/">July 2014</a> </li> <li> <a href="/blog/2014/06/">June 2014</a> </li> <li> <a href="/blog/2014/04/">April 2014</a> </li> <li> <a href="/blog/2014/03/">March 2014</a> </li> <li> <a href="/blog/2014/02/">February 2014</a> </li> <li> <a href="/blog/2014/01/">January 2014</a> </li> </ul> <h3> <a href="/blog/2013/">2013</a> </h3> <ul> <li> <a href="/blog/2013/11/">November 2013</a> </li> <li> <a href="/blog/2013/10/">October 2013</a> </li> <li> <a href="/blog/2013/09/">September 2013</a> </li> <li> <a href="/blog/2013/08/">August 2013</a> </li> <li> <a href="/blog/2013/07/">July 2013</a> </li> <li> <a href="/blog/2013/06/">June 2013</a> </li> <li> <a href="/blog/2013/05/">May 2013</a> </li> <li> <a href="/blog/2013/04/">April 2013</a> </li> <li> <a href="/blog/2013/03/">March 2013</a> </li> <li> <a href="/blog/2013/02/">February 2013</a> </li> <li> <a href="/blog/2013/01/">January 2013</a> </li> </ul> <h3> <a href="/blog/2012/">2012</a> </h3> <ul> <li> <a href="/blog/2012/12/">December 2012</a> </li> <li> <a href="/blog/2012/11/">November 2012</a> </li> <li> <a href="/blog/2012/10/">October 2012</a> </li> <li> <a href="/blog/2012/09/">September 2012</a> </li> <li> <a href="/blog/2012/08/">August 2012</a> </li> <li> <a href="/blog/2012/07/">July 2012</a> </li> <li> <a href="/blog/2012/06/">June 2012</a> </li> <li> <a href="/blog/2012/05/">May 2012</a> </li> <li> <a href="/blog/2012/04/">April 2012</a> </li> <li> <a href="/blog/2012/03/">March 2012</a> </li> <li> <a href="/blog/2012/02/">February 2012</a> </li> <li> <a href="/blog/2012/01/">January 2012</a> </li> </ul> <h3> <a href="/blog/2011/">2011</a> </h3> <ul> <li> <a href="/blog/2011/10/">October 2011</a> </li> <li> <a href="/blog/2011/09/">September 2011</a> </li> <li> <a href="/blog/2011/08/">August 2011</a> </li> <li> <a href="/blog/2011/07/">July 2011</a> </li> <li> <a href="/blog/2011/06/">June 2011</a> </li> <li> <a href="/blog/2011/05/">May 2011</a> </li> <li> <a href="/blog/2011/04/">April 2011</a> </li> <li> <a href="/blog/2011/03/">March 2011</a> </li> <li> <a href="/blog/2011/02/">February 2011</a> </li> <li> <a href="/blog/2011/01/">January 2011</a> </li> </ul> <h3> <a href="/blog/2010/">2010</a> </h3> <ul> <li> <a href="/blog/2010/12/">December 2010</a> </li> <li> <a href="/blog/2010/11/">November 2010</a> </li> <li> <a href="/blog/2010/10/">October 2010</a> </li> <li> <a href="/blog/2010/09/">September 2010</a> </li> <li> <a href="/blog/2010/08/">August 2010</a> </li> <li> <a href="/blog/2010/07/">July 2010</a> </li> <li> <a href="/blog/2010/06/">June 2010</a> </li> <li> <a href="/blog/2010/05/">May 2010</a> </li> <li> <a href="/blog/2010/04/">April 2010</a> </li> <li> <a href="/blog/2010/03/">March 2010</a> </li> <li> <a href="/blog/2010/02/">February 2010</a> </li> <li> <a href="/blog/2010/01/">January 2010</a> </li> </ul> <h3> <a href="/blog/2009/">2009</a> </h3> <ul> <li> <a href="/blog/2009/12/">December 2009</a> </li> <li> <a href="/blog/2009/11/">November 2009</a> </li> <li> <a href="/blog/2009/10/">October 2009</a> </li> <li> <a href="/blog/2009/09/">September 2009</a> </li> <li> <a href="/blog/2009/08/">August 2009</a> </li> <li> <a href="/blog/2009/07/">July 2009</a> </li> <li> <a href="/blog/2009/06/">June 2009</a> </li> <li> <a href="/blog/2009/05/">May 2009</a> </li> <li> <a href="/blog/2009/04/">April 2009</a> </li> <li> <a href="/blog/2009/03/">March 2009</a> </li> <li> <a href="/blog/2009/02/">February 2009</a> </li> <li> <a href="/blog/2009/01/">January 2009</a> </li> </ul> <h3> <a href="/blog/2008/">2008</a> </h3> <ul> <li> <a href="/blog/2008/11/">November 2008</a> </li> <li> <a href="/blog/2008/10/">October 2008</a> </li> <li> <a href="/blog/2008/09/">September 2008</a> </li> <li> <a href="/blog/2008/08/">August 2008</a> </li> </ul> </div> </div> </div> <script src="/assets/javascripts/app-8d34dc05.js" async=true></script> </body> </html>