<!DOCTYPE html> <html class=no-js lang=en> <head> <meta charset=utf-8> <meta content='width=device-width, initial-scale=1.0' name=viewport> <meta content='IE=edge,chrome=1' http-equiv=X-UA-Compatible> <title>Brain Matters</title> <link href="/assets/stylesheets/app-d7ac800e.css" rel=stylesheet /> <script src="/assets/javascripts/modernizr-84a49412.js"></script> <link href='/assets/images/favicon.ico' rel='shortcut icon'> </head> <body class='blog blog_2008 blog_2008_09 blog_2008_09_index f-topbar-fixed'> <div class='fixed raised'> <nav class=top-bar data-topbar role=navigation> <ul class=title-area> <li class=name> <h1> <a href='/'> <img alt="Agora Games" class=main-logo src="/assets/images/agoragames-new-8534f601.svg"/> </a> </h1> </li> <li class='toggle-topbar menu-icon'> <a href='javascript:void(0)'> <span>Menu</span> </a> </li> </ul> <section class=top-bar-section> <ul class=right> <li> <a data-anchor href='/#about'>About</a> </li> <li> <a data-anchor href='/#team'>Team</a> </li> <li> <a data-anchor href='/#contact'>Contact</a> </li> <li> <a href='/blog'>Blog</a> </li> <li class=hydra-theme> <a href='http://hydra.agoragames.com'> <img alt=Hydra width=92 src="/assets/images/hydra-wordmark-6248cf07.svg"/> </a> </li> </ul> </section> </nav> </div> <div class=row> <div class=columns> <h1 class=blog-page-title> <a href="/blog">The <strong>Blog</strong> </a></h1> </div> </div> <div class=row> <div class='columns large-9'> <div class=blog-page-subtitle> <h2>Posts from September 2008 </h2> </div> <div class=blog-entry-list><div class=blog-entry> <div class=blog__date> Sep 22 </div> <div class=blog__contents> <h2 class=blog__title> <a href="/blog/2008/09/22/50-software-development-50-community-design-and-management/">50% Software Development &amp; 50% Community Design and Management</a> </h2> <div class=blog__author> By <strong>Christian Arca</strong> </div> <div class=blog__body> <p><em>-What it takes to build a successful online gaming community</em></p> <p>The odds are against a business that is trying to build a branded online community (not unlike an online gaming community). According to a study performed by Deloitte and Beeline Labs, 35% of branded online communities have less than 100 members, and only 9% have more than 10,000 members. These businesses are investing heavily in these online communities, with 43% of the online communities operating with an annual budget of more than $50,000, and 6% with more than $1 million per year. These businesses realize that a successful online community has an incredibly high ROI, but the chances of failure are also high.</p> <p>Agora Games, Inc. has successfully developed over a dozen successful online gaming communities, with total community members exceeding 1.2 million. Our most recent gaming communities have hundreds of thousands of community members. While complex software engineering is needed to efficiently transfer terabytes of in-game data to and from the web, we believe that half of the success of an online gaming community is due to the community design and management of the site.</p> <p>Community design focuses on the creative process of “getting into gamers’ heads” to design web and in-game features that add value to the online community and video game. Before an engineer begins programming or a graphic designer starts drawing, our community designers develop a deep understanding of how the game will be played, and who will play it. The design process creates a framework for the online community experience that will help software engineers visualize how features should be implemented.</p> <p>Community management includes forum and content moderation, hosting and promotion of tournaments, email communication, YouTube video production, and many other proactive actions. Community managers are on the front-lines interacting with community members. The community managers and volunteer community members are integral to building a successful online community because they are the game fanatics that jumpstart and guide the community through its lifecycle.</p> <p>According to the Deloitte online community study, 34% of the communities only have part-time community managers, and only 16% have more than 6 full-time community managers. Directly after the launch of an online community, Agora dedicates multiple community managers exclusively to a community, which may scale-back over time. However, community managers are always needed for moderating the site, creating new tournaments, disseminating communications, and reporting community activity back to clients.</p> <p>Developing a successful online gaming community requires so much more than just the engineering of the underlying software. Half of the effort should be expended on software development, and the other half should focus on the creative process and engaging early community adopters. Too many companies think “if we build it, they will come.” Gamers are especially sophisticated, and desire quirky sites that connect with their identity. The end goal is to have an active site with engaged community members that extends game life and enhances game play.</p> </div> </div> </div> <div class=blog-entry> <div class=blog__date> Sep 4 </div> <div class=blog__contents> <h2 class=blog__title> <a href="/blog/2008/09/04/those-pesky-memory-leaks/">Those Pesky Memory Leaks</a> </h2> <div class=blog__author> By <strong>Jason LaPorte</strong> </div> <div class=blog__body> <p>First (technical) post!</p> <p>AgoraGames has been doing community sites for several years now, which means that some of them are pretty old and some of them have particularly unruly codebases, especially one such site. This site (which shall remain nameless to protect the guilty) ran perfectly fine at launch, but over the course of a year-and-a-half has slowly gone from speed-demon to slug-stuck-in-molasses.</p> <p><em>(I apologize for the lack of accompanying images, etc. as I worked through this… next time, I'll keep posterity in mind as I work through an interesting problem!)</em></p> <p>I'm the System Administrator here, so it's my job to make sure that everything stays running smoothly from the OS's standpoint; thanks to our religious use of <a href="http://www.tildeslash.com/monit/">monit</a>, the cause of the site's slowness was pretty obvious: the mongrels running the site would balloon to consuming a gigabyte of memory within minutes, forcing monit to kill-and-restart the servers. This is a Bad Thing (TM).</p> <p>Finding and fixing memory leaks in Rails isn't the easiest task in the world (as other bloggers have been apt to mention), but in this case, the path to fixing it was pretty straightforward.</p> <p>First task was to set up a separate bank of mongrels for the forums: since the site is so old, it's the only part of the site that gets much traffic these days. I told NGINX to proxy all requests starting with /forums to those. It worked just fine, and the forums were immediately quite quick. From looking at monit, it was pretty apparent that the forum mongrels didn't have the memory leak, since they ran without problems.</p> <p>So, to start digging into the main portion of the site, I booted up a local server in production mode and <a href="http://curl.haxx.se/">curl</a>ed the homepage. It took a whopping 222 seconds (and, from looking at <a href="http://en.wikipedia.org/wiki/Top_(Unix)">top</a>, consumed 800MB of memory!). Looking at the debug logs, virtually all of that time was spend doing two queries: loading forum posts with associations, and loading tournaments with associations. Sounds a bit sketchy, no?</p> <p>The home page's controller was laid out very logically, so mapping the SQL queries in the log to method invokations in the controller was simple. There were two methods that were killing us, and they both looked something like this:</p> <p><code>ruby class ForumPost &lt; ActiveRecord::Base ... def self.most_recent find(:first, :order =&gt; "forum_posts.created_at desc", :include =&gt; [:account, :forum_topic, :forum]) end ... end </code></p> <p>Apparently, the find is loading up the (tens of thousands) of forum posts, <em>with all the associated objects!</em> Ruby doesn't play nice when you have thousands of object in memory, and loading up hundreds of thousands of objects really makes things go south. Also makes sense why it didn't become a problem for a while – it's no big deal to load 100 object into memory (during testing and launch); but after a year and the site's forum starts to fill…</p> <p>But why? Isn't this doing a :first? Shouldn't it only be loading <em>one</em> object with associations? My guess is that Rails is loading all objects (with their associations) into an array and shifting off the first element. This isn't smart behavior, but would explain what we're seeing. (It's also worth noting that this is using a fairly old version of Rails; I believe this silliness is fixed in more recent versions.)</p> <p>Fixing this was actually trivial. Slap a :limit =&gt; 1 on there, or replace the :include with a :join. (Or, in the particular case above, remove the :include entirely. It's not being used for anything relevant.)</p> <p>I <a href="http://en.wikipedia.org/wiki/Grep">grep</a>ped the codebase for any other :includes, and fixed the ones that were broken. The site blazes along now and doesn't leak, just like it did in its glory days.</p> <p>Moral of the story: <strong>don't use includes lightly</strong>. Make sure you know what your finds are actually doing. In our case, it translated into memory leaks, but it could just as easily translate into high database load, which is just as bad.</p> </div> </div> </div> <div class=blog-entry> <div class=blog__date> Sep 2 </div> <div class=blog__contents> <h2 class=blog__title> <a href="/blog/2008/09/02/rock-to-our-goal/">Rock To Our Goal!</a> </h2> <div class=blog__author> By <strong>Nicole Plummer</strong> </div> <div class=blog__body> <p><img alt="" title="Rock To A Cure" src="http://farm4.static.flickr.com/3111/2809023484_5b6a4c0901.jpg?v=0"/></p> <p>This past Thursday, we hosted Rock To A Cure in partnership with Bombers Burrito Bar. The verdict, a total success. The final count of money raised was over $1,400! It was night which will be remembered - or be a blurry vision for those who had one too many Agora Gamers - by all. While the dinner crowd chowed down some burritos all of us were busy hyping up the crowd, raising awareness for the <a href="http://www.jdrf.org/">Juvenile Diabetes Research Foundation</a> (JDRF), and just being amiable hosts. Once the dinner crowd was finished with their burritos they were still hungry, hungry for Guitar Hero. Everyone started joining in to play Guitar Hero and Nicole was practically drowning in raffles. Luckily CZ was there to give a hand and rescue Nicole from the raffle abyss.</p> <p><img alt="" title="Burly Man vs Tall Man" src="http://farm4.static.flickr.com/3193/2808174871_7e7841e222.jpg?v=0"/></p> <p>If things weren't crazy enough already Mike DelPrete decided to "kick things up a notch" by suggesting some good ol' fashion arm wrestling. The burly Dave Loya took on contestants from the floor and went undefeated until the last round where one of the members of the crowd brought him down hard.</p> <p>The event went well past 10PM ending close to 11PM where everyone was eagerly awaiting the raffle of the XBox 360 which was taken home by a fine gentleman who was there the entire night and bought over $100 in raffle tickets! Definitely well deserved. With Rock To A Cure being such a success this is only the beginning to many more charity events to come.</p> </div> </div> </div> </div> </div> <div class='columns large-3'> <div class=blog-archives-sidebar> <h2>Blog archives</h2> <h3> <a href="/blog/2015/">2015</a> </h3> <ul> <li> <a href="/blog/2015/03/">March 2015</a> </li> <li> <a href="/blog/2015/01/">January 2015</a> </li> </ul> <h3> <a href="/blog/2014/">2014</a> </h3> <ul> <li> <a href="/blog/2014/12/">December 2014</a> </li> <li> <a href="/blog/2014/11/">November 2014</a> </li> <li> <a href="/blog/2014/10/">October 2014</a> </li> <li> <a href="/blog/2014/08/">August 2014</a> </li> <li> <a href="/blog/2014/07/">July 2014</a> </li> <li> <a href="/blog/2014/06/">June 2014</a> </li> <li> <a href="/blog/2014/04/">April 2014</a> </li> <li> <a href="/blog/2014/03/">March 2014</a> </li> <li> <a href="/blog/2014/02/">February 2014</a> </li> <li> <a href="/blog/2014/01/">January 2014</a> </li> </ul> <h3> <a href="/blog/2013/">2013</a> </h3> <ul> <li> <a href="/blog/2013/11/">November 2013</a> </li> <li> <a href="/blog/2013/10/">October 2013</a> </li> <li> <a href="/blog/2013/09/">September 2013</a> </li> <li> <a href="/blog/2013/08/">August 2013</a> </li> <li> <a href="/blog/2013/07/">July 2013</a> </li> <li> <a href="/blog/2013/06/">June 2013</a> </li> <li> <a href="/blog/2013/05/">May 2013</a> </li> <li> <a href="/blog/2013/04/">April 2013</a> </li> <li> <a href="/blog/2013/03/">March 2013</a> </li> <li> <a href="/blog/2013/02/">February 2013</a> </li> <li> <a href="/blog/2013/01/">January 2013</a> </li> </ul> <h3> <a href="/blog/2012/">2012</a> </h3> <ul> <li> <a href="/blog/2012/12/">December 2012</a> </li> <li> <a href="/blog/2012/11/">November 2012</a> </li> <li> <a href="/blog/2012/10/">October 2012</a> </li> <li> <a href="/blog/2012/09/">September 2012</a> </li> <li> <a href="/blog/2012/08/">August 2012</a> </li> <li> <a href="/blog/2012/07/">July 2012</a> </li> <li> <a href="/blog/2012/06/">June 2012</a> </li> <li> <a href="/blog/2012/05/">May 2012</a> </li> <li> <a href="/blog/2012/04/">April 2012</a> </li> <li> <a href="/blog/2012/03/">March 2012</a> </li> <li> <a href="/blog/2012/02/">February 2012</a> </li> <li> <a href="/blog/2012/01/">January 2012</a> </li> </ul> <h3> <a href="/blog/2011/">2011</a> </h3> <ul> <li> <a href="/blog/2011/10/">October 2011</a> </li> <li> <a href="/blog/2011/09/">September 2011</a> </li> <li> <a href="/blog/2011/08/">August 2011</a> </li> <li> <a href="/blog/2011/07/">July 2011</a> </li> <li> <a href="/blog/2011/06/">June 2011</a> </li> <li> <a href="/blog/2011/05/">May 2011</a> </li> <li> <a href="/blog/2011/04/">April 2011</a> </li> <li> <a href="/blog/2011/03/">March 2011</a> </li> <li> <a href="/blog/2011/02/">February 2011</a> </li> <li> <a href="/blog/2011/01/">January 2011</a> </li> </ul> <h3> <a href="/blog/2010/">2010</a> </h3> <ul> <li> <a href="/blog/2010/12/">December 2010</a> </li> <li> <a href="/blog/2010/11/">November 2010</a> </li> <li> <a href="/blog/2010/10/">October 2010</a> </li> <li> <a href="/blog/2010/09/">September 2010</a> </li> <li> <a href="/blog/2010/08/">August 2010</a> </li> <li> <a href="/blog/2010/07/">July 2010</a> </li> <li> <a href="/blog/2010/06/">June 2010</a> </li> <li> <a href="/blog/2010/05/">May 2010</a> </li> <li> <a href="/blog/2010/04/">April 2010</a> </li> <li> <a href="/blog/2010/03/">March 2010</a> </li> <li> <a href="/blog/2010/02/">February 2010</a> </li> <li> <a href="/blog/2010/01/">January 2010</a> </li> </ul> <h3> <a href="/blog/2009/">2009</a> </h3> <ul> <li> <a href="/blog/2009/12/">December 2009</a> </li> <li> <a href="/blog/2009/11/">November 2009</a> </li> <li> <a href="/blog/2009/10/">October 2009</a> </li> <li> <a href="/blog/2009/09/">September 2009</a> </li> <li> <a href="/blog/2009/08/">August 2009</a> </li> <li> <a href="/blog/2009/07/">July 2009</a> </li> <li> <a href="/blog/2009/06/">June 2009</a> </li> <li> <a href="/blog/2009/05/">May 2009</a> </li> <li> <a href="/blog/2009/04/">April 2009</a> </li> <li> <a href="/blog/2009/03/">March 2009</a> </li> <li> <a href="/blog/2009/02/">February 2009</a> </li> <li> <a href="/blog/2009/01/">January 2009</a> </li> </ul> <h3> <a href="/blog/2008/">2008</a> </h3> <ul> <li> <a href="/blog/2008/11/">November 2008</a> </li> <li> <a href="/blog/2008/10/">October 2008</a> </li> <li> <a href="/blog/2008/09/">September 2008</a> </li> <li> <a href="/blog/2008/08/">August 2008</a> </li> </ul> </div> </div> </div> <script src="/assets/javascripts/app-8ee17240.js" async=true></script> </body> </html>