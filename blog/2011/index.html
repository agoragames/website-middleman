<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"><meta content="width=device-width" name="viewport"><title>Brain Matters</title><link href="/assets/images/favicon.ico" rel="shortcut icon"><link href="/assets/stylesheets/all-e03354ba.css" media="all" rel="stylesheet" type="text/css" /><!--[if lt IE 9]><script src="/assets/javascripts/vendor/html5shiv-8b3747c5.js" type="text/javascript"></script><![endif]--></head><body><div class="outer-wrap"><div class="inner-wrap"><div class="wrap"><header class="clearfix" id="page"><a href="/"><img alt="Agora Games" id="logo" src="/assets/images/agora-games-logo-be83adf8.png"></a><nav><ul><li><a href="https://hydra.agoragames.com/">Products</a></li><li><a href="/portfolio/">Customers</a></li><li><a href="/us/">Team</a></li><li><a href="/community/">Community</a></li><li><a href="/work-at-agora/">Jobs</a></li><li><a href="/blog/">Blog</a></li></ul></nav></header></div><div class="wrap"><article class="clearfix"><header><h1>2011</h1></header><section id="blog-entries"><div class="blog-entry"><div class="date-comments"><div class="date">Oct 19</div></div><div class="blog-content"><h2><a href="/blog/2011/10/19/up-and-running-with-zappa-coffeescript-mongoose-3/">Up and running with Zappa, Coffeescript & Mongoose</a></h2><div class="blog-author">By <strong>Brian Corrigan</strong></div><div class="blog-body"><p>At <a href="http://www.majorleaguegaming.com">Major League Gaming</a> we recently launched an internal profile service using NodeJS. In an effort to get more familiar with Node, I decided to use it on my latest personal project. In addition, since CoffeeScript is now included out of the box in Rails 3.1 I decided it was time to try that too. Here's a simple app to get you up and running with <a href="http://www.nodejs.org">Node</a>, <a href="http://www.zappajs.org">Zappa</a>, <a href="http://jashkenas.github.com/coffee-script/">Coffeescript</a> &amp; <a href="http://mongoosejs.com/">Mongoose</a>.</p>

<p>To get it working:</p>

<ul>
  <li>Install MongoDB</li>
  <li>Install NodeJS</li>
  <li>Install NPM</li>
  <li>npm install -g mongoose</li>
  <li>npm install -g zappa</li>
  <li>Run the gist 'coffee file.coffee'</li>
</ul>

<p>Dig it?  Follow me  <a href="http://twitter.com/#!/genexp">@genexp</a></p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Oct 4</div></div><div class="blog-content"><h2><a href="/blog/2011/10/04/how-to-create-a-user-on-s3-and-grant-access-to-a-bucket/">How to: Create a user on S3 and grant access to a bucket </a></h2><div class="blog-author">By <strong>Brian Corrigan</strong></div><div class="blog-body"><p>In our never ending quest to spend more time on software creation and less time on software administration <a href="http://twitter.com/#!/clarkefoley">Clarke</a> and <a href="http://twitter.com/#!/genexp">I</a> moved our content team from a self managed FTP site to an S3 account.</p>

<p>Besides, administering an FTP site is so 1971.</p>

<p>It took an hour or two to figure out the proper permissions, so I'm documenting them here for posterity. Read on if you're interested.</p>

<ol>
  <li>Login to the S3 management tool and create a bucket. Write down the name!</li>
  <li>Login to the <a href="https://console.aws.amazon.com/iam/home">Amazon Identity &amp; Access Management</a> tool and create a group.</li>
  <li>Create users and add them to the group you created. Write down the secret key and access key for each user.</li>
  <li>Edit the group and attach a group policy. Here's the one I used.</li>
  <li>Download <a href="http://cyberduck.ch/">Cyberduck</a> - It's cross-platform, open source and is simple to setup and use. While you're there donate a few bucks. <code>{
 "Statement": [
 {
 "Action": [
 "s3:ListAllMyBuckets"
 ],
 "Effect": "Allow",
 "Resource": "arn:aws:s3:::*"
 },
 {
 "Action": "s3:*",
 "Effect": "Allow",
 "Resource": [
 "arn:aws:s3:::my_bucket",
 "arn:aws:s3:::my_bucket/*"
 ]
 }
 ]
 }</code></li>
  <li>Open up Cyberduck, choose Amazon S3 and test using a Secret Key/Access Key pair.</li>
</ol>

<p>Done!</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Sep 30</div></div><div class="blog-content"><h2><a href="/blog/2011/09/30/make-your-databases-work-smarter-not-harder/">Make Your Databases Work Smarter, Not Harder</a></h2><div class="blog-author">By <strong>Jason LaPorte</strong></div><div class="blog-body"><p>When optimizing code, you <a href="http://en.wikipedia.org/wiki/Profiling_(computer_programming)">profile</a> it, find out where it's spending most of it's time, and figure out how to make it spend less time there. As a sysadmin, I tend to wear a lot of hats, but the one I wear the most by far is the <a href="http://en.wikipedia.org/wiki/Database_administrator">DBA</a> hat–I spend far more time hacking on <a href="http://www.mysql.com/">MySQL</a> optimizations than any particular other thing I do. So, in order to make myself more efficient, if I can find a way to streamline the time I spend with MySQL, I can reap the biggest benefits.</p>

<p>It turns out doing so isn't so hard. Here are some tricks I've learned.</p>

<p>Now, the reason I spend so much time with MySQL is that it's a prime cause for bottlenecks in our applications. Those bottlenecks tend to fall into three categories:</p>

<ol>
  <li>
    <p>The queries cause tables to lock, halting further queries until the first completes.</p>
  </li>
  <li>
    <p>The queries are improperly indexed, requiring queries to examine or sort the entire table when they don't have to.</p>
  </li>
  <li>
    <p>The queries act on more data than the system can adequately manage at once.</p>
  </li>
</ol>

<p>There are different solutions to each of the above problems. I'll walk through a few of them, but before I do, let me start with the lowest-hanging fruit that is common to all three: <a href="http://dev.mysql.com/doc/refman/5.5/en/upgrading.html">upgrade to the latest version of MySQL</a>, and then upgrade to <a href="http://www.percona.com/software/percona-server/">Percona Server</a>. Percona Server is a drop-in replacement for MySQL than has <a href="http://www.percona.com/software/percona-server/benchmarks/">tighter optimization</a> and better monitoring features. And when I say drop-in replacement, I really mean <em>drop-in replacement</em>: installing it is literally trivial. We've done so on both Ubuntu 10.04 Server and RHEL 5, and the process in both cases was backup your data (just in case), remove the MySQL Server package, and then install the Percona Server package. That's it. All of your client libraries will continue to work, you can still use handy performance tools like <a href="https://github.com/rackerhacker/MySQLTuner-perl">MySQL Tuner</a> and <a href="http://jeremy.zawodny.com/mysql/mytop/">MyTop</a>, you can even continue replicating to your non-Percona slaves (which you should also upgrade, of course). It grants you instant benefits for virtually no investment.</p>

<p>After that, we can't know what process to take to optimize a query without knowing what queries need to be optimized. We at Agora use several tools for tracking them down. The main tools we use are:</p>

<ol>
  <li>
    <p><a href="http://munin-monitoring.org/">Munin</a>, which is trending software: it tracks statistics over time and plots them onto a graph. While we're not 100% happy with Munin, it's issues are easy enough to work around (should you be at the scale that requires working around them), and there's nothing simpler for getting up and running quickly. This can query MySQL's statistics counters and plot them, so you can see all manner of data on how your server is behaving: from memory usage, to breakdowns of query types, to number of slow queries, to disk access patterns, and so on.</p>
  </li>
  <li>
    <p>The <a href="http://dev.mysql.com/doc/refman/5.5/en/slow-query-log.html">MySQL slow query log</a>, which simply logs any queries that took longer to execute than some (easily configured) threshold.</p>
  </li>
  <li>
    <p>The <a href="http://dev.mysql.com/doc/refman/5.5/en/explain.html">EXPLAIN SELECT</a> query will identify how MySQL interprets a given query, allowing you to identify how expensive your queries are, and how well-utilized your indices are. (EXPLAIN is very powerful, but also confusing. I recommend looking it up on Google. <a href="http://weevilgenius.net/2010/09/mysql-explain-reference/">Here</a> is an explanation in further detail.)</p>
  </li>
  <li>
    <p>The <a href="http://dev.mysql.com/doc/refman/5.5/en/show-processlist.html">MySQL SHOW PROCESSLIST</a> query, which can help identify locking queries while they're running. One notable benefit of Percona is that it is much better about showing the current state of a query, and how many rows are being acted upon, than MySQL, which makes it easier to track down what the problematic part of a query is.</p>
  </li>
  <li>
    <p>MySQL Tuner is a little Perl script that helps identify common causes on a MySQL Server by running <a href="http://dev.mysql.com/doc/refman/5.5/en/show-variables.html">SHOW VARIABLES</a> and comparing the output to several heuristics. While this isn't as useful when you have a lot of experience tuning MySQL's variables, it's enormously useful if you havn't.</p>
  </li>
</ol>

<p>Our usual process is to identify when we hit performance issues with Munin, check the slow query log at those times to identify problem queries, and then use EXPLAIN, SHOW PROCESSLIST, and MySQL Tuner (and/or looking directly at SHOW VARIABLES, if you know what you're doing) to help identify <em>why</em> the queries are problematic.</p>

<p>While I'd love to break down every possible symptom I've seen and how it can be fixed, that could easily fill a book. (And, in fact, a quick search on Amazon reveals that it already does.) So, you're just going to have to use your intuition (and Google) to track it down yourself. The most important quality is having an inquisitive nature. If you see that something's wrong, instead of looking for a magic word that fixes it, try to understand what's going on <em>behind</em> the visible symptoms, or try to understand <em>why</em> the magic word works.</p>

<p>Let me walk through common solutions to the three above types of problems to get you started.</p>

<p>Let's suppose that you're finding, via SHOW PROCESSLIST, that a number of processes are piling up due to a locked query. What would you do to fix that? I would first start by looking at the table's engine (most easily seen by <a href="http://dev.mysql.com/doc/refman/5.5/en/show-create-table.html">SHOW CREATE TABLE</a>). If the table is <a href="http://dev.mysql.com/doc/refman/5.5/en/myisam-storage-engine.html">MyISAM</a>, try converting it to <a href="http://dev.mysql.com/doc/refman/5.5/en/innodb-storage-engine.html">InnoDB</a>. InnoDB has a lot more overhead, but in exchange it never locks a whole table at once; so while individual queries will require more time, they won't preclude other queries from running. Let's suppose that your tables are already InnoDB, or that for some reason they can't be (for example, you're relying on <a href="http://dev.mysql.com/doc/refman/5.5/en/fulltext-search.html">FULLTEXT</a> indices, which InnoDB does not support). The next thing I'd check is to ensure your various <a href="http://dev.mysql.com/doc/refman/5.5/en/server-parameters.html">server tuning variables</a> are adequately sized. This is a very complex topic with lots of things to fiddle with, but I recommend running MySQL Tuner as a starting point. Common problems are setting the MyISAM key buffer or the InnoDB buffer pool too small, causing your database to swap. If you've already checked that, then your problem may be the efficiency of your indices.</p>

<p>You can identify how your indices are being used by running EXPLAIN to see how the query is being executed. If it's doing a full table scan, creating a temporary table, or performing a filesort, you should either create a new index or restructure the query. Additionally, be aware that indices add overhead: whenever the table is modified, each index needs to be updated as well. Oftentimes the overhead in doing so can cause locks, especially on expensive indices (such as indices on a large number of columns, on large text columns, or any FULLTEXT indices). You may need to evaluate how the table is being accessed and remove any unnecessary indices, so there's less overhead needed. For example, we had a number of FULLTEXT indices on Gamebattles that were causing a large number of table locks in order to keep them updated. We ended up moving to <a href="http://sphinxsearch.com/">Sphinx</a> for FULLTEXT indexing and removing the indices in MySQL.</p>

<p>Finally, the greatest bane of MySQL is hitting disk. If you ever have to swap memory to disk ever, then your database performance will drop like a rock. If Munin or MySQL Tuner indicate that your disk usage is too high, look at increasing your buffer sizes. If you've maxed your system's physical RAM, then you should buy more. If you have adequate RAM but your disks are still too slow, buy faster disks. When in doubt, <a href="http://www.livestream.com/oreillyconfs/video?clipId=pla_3beec3a2-54f5-4a19-8aaf-35a839b6ecaa">spring for SSDs</a>.</p>

<p>While this is a pretty quick overview of how to approach debugging inefficiencies in your databases, I hope that you'll find it helpful. If you're interested in more detailed reviews of any particular point (as there's an almost bottomless amount of practical wisdom to be acquired when dealing with MySQL), feel free to let me know via the comments.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Sep 23</div></div><div class="blog-content"><h2><a href="/blog/2011/09/23/the-art-of-refactoring/">The Art of Refactoring</a></h2><div class="blog-author">By <strong>Jason LaPorte</strong></div><div class="blog-body"><p><a href="http://gamebattles.majorleaguegaming.com/">GameBattles</a> is one of our most popular sites, with an active user base in the millions. While we've dealt with sites in that scale before, this particular case has been no walk in the park. While we're a Rails shop, the fact that the site is written in PHP actually has nothing to due with the difficulties we've encountered. The real problems are that the codebase is almost a decade old, has been developed by dozens of developers over that time, has grown organically with a clear roadmap defined only recently, and has almost never been refactored.</p>

<p>So, at various intervals over the last year, I (and others) have been digging into the site and trying to clean up what we can. It seemed that the process of what weve been doing is interesting, but talking about it at any length has been something I've hesitated to do, as I don't like talking about something without quantifiable statistics. But, the fact of the matter is, programming is an art, not a science, and anyone who says different is selling something. And the real trick with refactoring is that it doesn't meet any immediate business goals: it's purpose is entirely human, as it entirely exists to make a clean and sane working environment. All of the tangible business gains (security, performance, developer velocity, etc.) are all secondary, and so unless your managers "get it," it can be a hard thing to argue for.</p>

<p>In our case, it's no secret that GameBattles' stability was going downhill, and so we needed to do something. And the only way for us to be able to audit for problems was to make the codebase manageable.</p>

<p>Let me give you a sense of where we started: the code was in <a href="http://en.wikipedia.org/wiki/Revision_control">version control</a>, but only in the technical sense of the word; in reality, <a href="http://en.wikipedia.org/wiki/Apache_Subversion">SVN</a> was being used more as an excessively complicated <a href="http://en.wikipedia.org/wiki/Rsync">rsync</a>—it was a means to transport code from one developer machine to many web servers. The repository was over two gigabytes in size, about a third of which was PHP code, and the remainder being static assets. (And this is in addition to static assets housed elsewhere, such as on our CDN.) There were at least four PHP frameworks and three CMSs. Some of the code was object-oriented PHP5, but plotting a class diagram would have required at least four dimensions. If you think you've seen spaghetti code, think again: walking into this mess was like walking into the alien hive.</p>

<p><img alt="" title="ripley-nest" alt="" width="520" height="274" src="/assets/images/uploads/2011/09/ripley-nest-c0b53b53.jpg" /></p>

<h2 id="there-is-no-magic-in-refactoring-when-the-scale-is-monumental-you-should-fully-expect-nothing-other-than-a-long-tedious-trek-on-any-journey-though-youll-need-a-guide-here-are-some-of-the-rules-of-thumb-that-ive-been-going-by">There is no magic in refactoring. When the scale is monumental, you should fully expect nothing other than a long, tedious trek. On any journey, though, you'll need a guide. Here are some of the rules of thumb that I've been going by:</h2>

<p>Always, <em>always</em> start with the low-hanging fruit. Your task is both difficult and boring. Don't make it any harder than it already has to be.</p>

<p>-</p>

<p>Similarly, start with broad strokes. Try to find where you'll experience the biggest gains first, and don't work on things with small returns until you're reasonably sure there's nothing bigger.</p>

<p>-</p>

<p>However, working on anything is better than working on nothing, so don't dither. Be decisive.</p>

<p>-</p>

<p>Make lists. I, personally, keep three: <em>alive</em>, <em>dead</em>, and <em>unsettled</em>, each referring to files in the codebase. Alive files are those known to be (at least partially) necessary to the core functionality of the site. Dead files are those known to be not referenced by anything alive. Unsettled files are those you just don't know enough about. Never fail to keep these lists up to date, even though you'll be changing them almost constantly. Yes, it's tedious, but it's necessary.</p>

<p>-</p>

<p>Use common sense. Trust your feelings. If something seems important, it probably is. If something seems useless, it probably is. If the files havn't been updated in over two years, they're very likely dead.</p>

<p>-</p>

<p>Sometimes you're lucky and you can nuke entire files. Sometimes you're not and you have to perform surgery on files to remove the parts that don't need to be there. Don't be afraid to dive in, but remember: don't get in over your head. If you need to make a lot of changes for a small gain, move on to somewhere else for now. You can always come back later.</p>

<p>-</p>

<table>
  <tbody>
    <tr>
      <td>If you're not on a UNIX system, get on one. Your best friends in this process are _ <a href="http://en.wikipedia.org/wiki/Find_(Unix)">find</a>_ and _ <a href="http://en.wikipedia.org/wiki/Grep">grep</a>_, and I can't even imagine where you'd begin without them. Find is a tool that lets you scan for files on disk based off of a number of parameters—name, type, last updated time, etc. Grep, of course, lets you search the contents of files. You can chain them together, too: I have probably typed find . -type f -name '*.php'</td>
      <td>xargs grep 'search term' more times than I can count—that snippet will search all PHP files in (or below) the current directory and tell you which ones contain the search term. (You can also just use grep -R 'search term' .—which does nearly same thing—if you don't have a lot of binary files that will take up a lot of search time.) This is particularly handy for seeing if a class or database table is referenced somewhere.</td>
    </tr>
  </tbody>
</table>

<p>-</p>

<p>In fact, the above is true pretty much universally. If you're not an expert with <em>find</em> and <em>grep</em>, and how to use them together, become one. There are <a href="http://linux.die.net/man/1/find">many</a> <a href="http://find.unixpin.com/">good</a> <a href="http://linux.die.net/man/1/grep">resources</a> on how to use them.</p>

<p>-</p>

<p>Looking at the database is a great heuristic for what's important and what's not. Recent versions of <a href="http://mysql.com/">MySQL</a> (which is what we use for GameBattles' backend) actually have a lot of useful metadata hiding in the <a href="http://dev.mysql.com/doc/refman/5.0/en/tables-table.html">information_schema.TABLES</a> table—things like how large a table is (both in rows, and bytes), when it was last written to, and so on. If you find tables that haven't been updated in a year, then they're probably not used, and any files that reference them probably aren't either. Additionally, if you find tables that are written to but never read from, they're dead. Delete the references and then delete the table.</p>

<p>-</p>

<p>Make backups of everything. Date them. Have a rollback plan <em>in writing</em> for when you delete something a little overzealously, since your brain is going to be far too fried when you're in the thick of it to do anything other than follow instructions.</p>

<p>-</p>

<p>Once you've gotten rid of something, deploy it immediately. Not only will you find if you broke the world while what you did is still fresh in your mind, but it's also remarkably cathartic to put some closure on what you just accomplished. And you will need the positive reinforcement.</p>

<p>I cannot emphasize the human factor of the above notes enough. The entire point of refactoring is maintaining your sanity. Don't sacrifice it in the process.</p>

<p>While the labor is toilsome, the rewards are unparalleled. GameBattles codebase is currently an eighty-megabyte <a href="http://en.wikipedia.org/wiki/Git_(software)">Git</a> repository, less than four percent of the size of what we started with. The number of potential security holes has dropped like a rock. Our uptime has gone from less than two " <a href="http://en.wikipedia.org/wiki/Nines_(engineering)">nines</a>" to almost four, and is continuing to improve. Our developers are moving faster than ever. Our users are happier. And, most importantly, I havn't lost my mind. (Yet.)</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Aug 22</div></div><div class="blog-content"><h2><a href="/blog/2011/08/22/how-can-you-keep-up-with-modern-marketing/">My grandfather is on Facebook, why aren't you?</a></h2><div class="blog-author">By <strong>Leslie Brezslin</strong></div><div class="blog-body"><p>The world is changing. It’s a blue sphere in constant motion; every second of the day produces a new life changing thought. Whether that thought is acted upon or publicized however, is debatable. Considering that fact, one of the greatest things about human nature is that we are prone to adaptation. As our environments change (consequently we are normally the cause of change), we find ways to change with. Now that that’s out of the way, marketing is a topic that’s been around since the establishment of trade. How else would you draw people to your wooden establishment and convince them that your corn is better than your neighbor’s?</p>

<p>The reality is that marketing has been an essential part of history and those who effectively master the far from dying art, are the most successful. Lets look at Apple for example. Their focus has been brand management since CEO Steve Jobs hopped on board. Because of this, they’ve gone from near bankruptcy to one of the top companies in the world. As of August 1, they held more cash on hand than the United States treasury. Are they selling any products that are necessary for survival of mankind? Are their products much different from those on the market?</p>

<p>The answer to both questions in my opinion, is no. I consciously know that there are phones that can do much more than the iPhone can. I also know that there are phones that are much more customizable and free from Apple’s unreasonable restrictions, but I want an iPhone. I know that a Windows computer has the same capabilities if not more than Mac computers, but I want the Mac even though it costs more. Why do think that is?</p>

<p>It’s all about the way Apple markets their products. They’ve successfully made it to the point where it’s sort of a social “norm” to have certain items. Apple products are now for the most part, fashion statements. I remember when the iPod first came out. Everyone at school wore them on their belt buckles with their shirts just above the clip so that it could be seen. Guess what, if you didn’t have one, you felt left out. Fast-forward to a few years later and it’s on a greater scale, meanwhile the main beneficiary is Apple.</p>

<p>So now that we’ve established the importance of marketing, how has it changed over the years? Well for one thing, you’re dealing with a new generation. Before, you had all the power and control when it came to your audience. Flash the ads on the television or radio and no matter how reluctant a viewer, the reality was that they had no choice but to watch. That was then, nowadays, people have much more control. With things like Tivo and the Internet, your audience decides what to watch and when to watch it (same goes for all other types of media). Not only that, the generation isn’t on the floor with their mom and dad, watching The Brady Bunch anymore. They’re on Facebook, Twitter or YouTube and spending countless numbers of hours a month there (I know because I am one of them). So how can you reach an audience that is no longer passive and won’t sit through your boring pitches? It’s simple, change your tactics.</p>

<p>First, go to where they are; don’t wait for them to come to you. Second, ask what they would like to see or what types of products they’d like to see advertised. If your product isn’t included on their lists, then you save you time and money. The fact is, people are unlikely to buy a product that they’re not in the market for. There’s been several times on YouTube where I’d be watching an ad and right before the time is up, they ask if I found the ad relevant. I normally said no in hopes of eliminating them completely but if it were for a product that I was in the market for, I would have definitely said yes.</p>

<p>If you look at some of the ads on those videos, they are a lot of the times relevant to what the video is showing. The fact of the matter is, if I typed in “ how to play blackbird” into YouTube, there is a huge probability that I’m interested in the guitar. Maybe I want a new one or maybe I want local lessons. At this point I don’t even watch television anymore so I, like many others, won’t sit and endure just any product pitch.</p>

<p>As far as Facebook and twitter, those are respectively the 2nd and 9th ranked sites on the Internet. That being said, there is a high probability that your market is there, so why aren’t you? Every company should have a Facebook and Twitter profile in my opinion, even if it is just informative. The point of those sites is self-expression. As it is “cool” to own Apple products (I think I might be on my way to becoming a fan boy), I want to “like” Apple on Facebook so that my network knows, “ hey, I’m cool”. As dorky as that sounds, that is the simplified version of the image you need to create for your company. People should want to be associated with it. Additionally, I’ll add that if you have people on your Facebook constantly pitching products at me, I will “de-friend” or “unlike” you.</p>

<p>That brings us on to the Twitter regime. Twitter is an amazing way to interact with your customers (the key to modern marketing – interaction). With it, you can easily find out what they like, their issues and inform them of your upcoming products. Like anything however, it can easily be abused. Consider this situation, you are following 50 people; one of those is a company. We’ll say that the remaining 49 update their statuses about 5 times a day. If you as a company are updating you status every thirty minutes, you’re spamming that person’s feed. So what’s the result? Your number of followers goes down by one whether or not they liked you. One of our practices at Agora is to update the status every 2 hours and respond to questions every hour. This way we remain visible and give our community an efficient response time without spamming everyone else.</p>

<p>So what are the lessons to be learned here? Target your market, go to the places that they spend most of their time and be courteous. They now have the power to choose what they will allow themselves to be exposed to so keep it relevant. Additionally, one last piece of advice, don’t use them to market your products alone. Give people information that they would like to know about as well. For example, we do not work with nor endorse Game Informer in any way shape or form. However, they post information on their site that is relevant to our audience, information that we do not specialize in producing. Since the majority of our community are gamers and would like to be kept informed, we link to some of their updates. So now that you know what it takes to formulate a success like Apple’s, what will you do with it? Let us know in the comments below or on <a href="http://www.twitter.com/agoragames">Twitter</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Aug 12</div></div><div class="blog-content"><h2><a href="/blog/2011/08/12/what-is-it-like-interning-with-agora-games/">What is it like interning with MLG?</a></h2><div class="blog-author">By <strong>Brian Corrigan</strong></div><div class="blog-body"><p>What is it like Interning at Major League Gaming?</p>

<p>“I honestly can't find the difference between an intern and a regular employee. Employees get one trip to a related conference every year; I was also sent to one. Employees may go to MLG events and I've been to two. I deploy apps to production on a daily basis, make design decisions when required and am involved in the process from top to bottom. That is why I feel MLG has been a great experience, because I've been completely immersed in the software development process. “– Matt Perry (Intern)</p>

<p>You’ve learned a bit in school, but don’t know if you’re ready for the elite work force. Well, most of us have been there so we understand. I guess one of the royalties of an internship is that you’re not expected to know everything. School has set the foundation for you and now its time to start conditioning your catalogue with experience. That’s the exact same feeling that troubled me in the beginning of this summer, so I figured that my perspective might be useful to anyone considering an internship at Major League Gaming.</p>

<p>To begin, you’re treated and welcomed like any other employee. Also aside from compensation, the main difference between an intern and a full time person is that the interns are expected to make basic mistakes. They know that most of us lack experience and probably won’t know exactly what we’re doing so we’re granted mentors. Additionally, the work that you are given is not very different from the projects that you’d be working on as a full time employee. So, with that in mind, exude the thought that you’ll be assigned tasks like operating the fax machine, making coffee, or fetching the mail when it arrives. The work that you are assigned is very valuable and is usually necessary for projects to progress.</p>

<p>“When you first start, you are taught the basic processes that allow to you integrate with the MLG workflow. After you’ve become familiar with these processes, depending on your role, you may start tending to issue tracking tickets, working on independent projects or working with your team on high-level projects. One thing is for sure: you will be challenged, so bring your A-game.” – Cameron Cope (Intern)</p>

<p>At some point they we’re all students so they understand the pressures and troublesome schedules that you’ll show up with. As long as you’re willing to apply yourself and learn, they are willing to work with you. Also, a lot of the current employees started out as interns so there's always the possibility of being hired full time. It all really depends on your aspirations.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Aug 11</div></div><div class="blog-content"><h2><a href="/blog/2011/08/11/what-do-zombies-devs-and-300-have-in-common-hack-a-thon/">What do Zombies, devs and 300 have in common? Hack-a-thon!!</a></h2><div class="blog-author">By <strong>Brian Corrigan</strong></div><div class="blog-body"><p>August 4th 3:00 PM: Excitement looms in their eyes as they await the fourth coming. An extraordinary combination of producers, interns, devs and more, unify to kick off the event of the century: Hack-A-thon 4. What is a Hack-a-thon you ask? Well, I'm glad you did because only the foolish can live in ignorance of the mankind’s greatest celebration. It is only that moment that we’ve all dreamed of and considered impossible as children. The one moment that all of our parents told us about, but never truly believed we’d actually see. The period when you’re granted the highest level of honor and allowed 24 hours to work on any project that should strike your chord of desire. Brilliant, isn’t it? Now, the Agorians are an interesting people. Masters of the event is only the least that could be said of their Hack-a-thon abilities.</p>

<p>Seeking the guiding words that will resound with them through the night’s perils, they sit restlessly as they await the official orders of the commander.
 <img alt="" alt="" width="300" height="224" src="/assets/images/uploads/2011/08/P1000429-300x224-b075bdca.jpg" /></p>

<p>In a flash, he enters and our leader speaks. The speech rebounds off of the walls with power and echos through everyone’s mind. Simultaneously, he is demanding yet asking, telling yet not, requiring but not really. More or less something like this:</p>

<p>http://www.youtube.com/watch?v=TeNGVS2T_Rk</p>

<p>Having internalized the words that would hype them up to a sense of self-belief and desire to work, the diverse people of the Agora rejoice. They then disperse to attack the monstrous tasks that they have chosen to resolve.</p>

<p>Agust 4th 7:00PM: Although four hours have passed, the Agorians are still hard at work. Their determination prevents any pesky amount of noise or discomfort from discouraging them and preventing the success of the vision at hand. They have a task to fulfill and intend to do so. Bright eyed and in high spirit, they continue to bang away at their instruments.</p>

<p><img alt="" alt="" width="300" height="224" src="/assets/images/uploads/2011/08/P1000440-300x224-74f8373c.jpg" /></p>

<p>Some have even been inspired to a level where chairs are irrelevant; working while standing up, an unnecessary yet amazing triumph.</p>

<p><img alt="" alt="" width="300" height="224" src="/assets/images/uploads/2011/08/P1000458-300x224-b0928dfd.jpg" /></p>

<p>August 5th 1:00 AM: Signs of tire begins to appear as the day progresses…</p>

<p><img alt="" alt="" width="300" height="225" src="/assets/images/uploads/2011/08/P1000447-300x225-8d78989b.jpg" /></p>

<p>August 5th 5:00AM: The Agorians have taken the ultimate form of humankind. The zombie. Driven by their goals, the Agorian continues. He continues working without the slightest thought of rest.</p>

<p><img alt="" alt="" width="300" height="168" src="/assets/images/uploads/2011/08/zombieatwork-300x168-5686849d.jpg" /></p>

<p>Having diligently continued regardless of the obstacles, 3:00 PM arrives and the event is concluded. All of the Agorians meet at the same place that their tasks were appointed to speak of their successes and failures. Another grand Hack-a-thon has been successfully completed. Many accomplishments came out of this event and will be implemented into the natural flow of life soon. Visit our <a href="http://www.facebook.com/agoragames">Facebook</a> for more photos and because we're cool.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Aug 10</div></div><div class="blog-content"><h2><a href="/blog/2011/08/10/chef-explosion/">Chef Explosion</a></h2><div class="blog-author">By <strong>Waldo Grunenwald</strong></div><div class="blog-body"><p>Here at MLG, we use a product from Opscode called Chef to manage our server environments. Chef allows us to reliably manage our infrastructure by providing us with the ability to write code that describes how a server should be configured. While not perfect, it has served us well.</p>

<p>Chef leverages CouchDB for it's datastore. CouchDB is "NoSQL" database product, similar in concept to MongoDB. CouchDB provides a lot of features and usability, but as a tradeoff for versioning, speed, and convenience it sacrifices disk space. In OpsCode's documentation, they do helpfully point out in the <a href="http://wiki.opscode.com/display/chef/CouchDB+Administration+for+Chef+Server">"CouchDB Administration for Chef Server" page</a> that you should periodically run a Compaction. Basically what this does is remove some of the older versions of documents.</p>

<p>Following their advice, we set it up as a weekly cron (in our Cron cookbook, naturally), and so it looks like this:</p>

<p><code>ruby
cron 'Compact Chef DB' do
  user 'nobody'
  weekday '1'
  hour '4'
  minute '0'
  command 'curl -X POST http://localhost:5984/chef/_compact'
end
</code></p>

<p>which results in a crontab entry that looks like this:</p>

<p><code>
# Chef Name: Compact Chef DB
 0 4 \* \* 1 curl -X POST http://localhost:5984/chef/_compact
</code></p>

<p>One fine summer morning I came in one morning to several thousand emails saying "Chef Run Failed." This, as you may understand, severely degraded my opinion of the morning.</p>

<p>Cue the Swedish Chef crying "Bork Bork Bork!"</p>

<p>After I determined that a full disk was the problem and deleting an old unneeded backup file to get some headroom, I found that the biggest contributor was the /var/lib/couchdb/0.10.0/.chef_design directory.</p>

<p><code>
root@chefserver:/var/lib/couchdb/0.10.0/.chef_design# ls -lh
 total 96G
 -rw-rw-r-- 1 couchdb couchdb 30M 2011-07-21 18:26 07ccb0c12664d1f1ca746003182b521a.view
 -rw-r--r-- 1 couchdb couchdb 1.7G 2011-05-11 12:03 178087e2a7c06ff437482555acf60bab.view
 -rw-rw-r-- 1 couchdb couchdb 8.5G 2011-07-22 08:24 18757f7428c465dd0504ac3d5d7ce577.view
 -rw-rw-r-- 1 couchdb couchdb 8.9G 2011-07-22 08:24 367772ed026257ff1f88a1011576c9c3.view
 -rw-rw-r-- 1 couchdb couchdb 6.6M 2011-07-21 15:52 3970d32b6acb424bb4d19684bdf9aff1.view
 -rw-r--r-- 1 couchdb couchdb 8.6M 2011-07-22 08:11 91188e3c7d61bdf079eee6ca719be05c.view
 -rw-rw-r-- 1 couchdb couchdb 6.0G 2011-03-16 16:44 9f39fce5f578a23cc8cad7b3fe9b8ce9.view
 -rw-r--r-- 1 couchdb couchdb 1.4G 2011-07-22 08:24 af280ad217f6edca6276d1d1bcbc069d.view
 -rw-rw-r-- 1 couchdb couchdb 19G 2011-05-11 12:00 b96879fe1377e2b91f228109f3aac384.view
 -rw-rw-r-- 1 couchdb couchdb 565K 2011-07-20 09:31 be708387555557a5b4886292346da6bb.view
 -rw-rw-r-- 1 couchdb couchdb 3.0M 2011-07-20 11:27 d381d1f4b207dc3d9624720a7e88f881.view
 -rw-r--r-- 1 couchdb couchdb 51G 2011-07-22 08:20 fe06cf9119d23dd7fec2492b79e7ebef.view
</code></p>

<p>I was surprised that there was so much disk use, since we had been running the Chef Compactions, and expected this kind of thing to be taken care of. Wondering if it was throwing some kind of error that we weren't seeing (since it's running as a cron), I ran it manually:</p>

<p><code>
root@chefserver:~# curl -H "Content-Type: application/json" -X POST http://localhost:5984/chef/_view_cleanup
 {"ok":true}
</code></p>

<p>Which yielded:</p>

<p><code>
root@chefserver:/var/lib/couchdb/0.10.0/.chef_design# ls -lh
 total 70G
 -rw-rw-r-- 1 couchdb couchdb 30M 2011-07-22 08:43 07ccb0c12664d1f1ca746003182b521a.view
 -rw-rw-r-- 1 couchdb couchdb 8.5G 2011-07-22 08:43 18757f7428c465dd0504ac3d5d7ce577.view
 -rw-rw-r-- 1 couchdb couchdb 8.9G 2011-07-22 08:43 367772ed026257ff1f88a1011576c9c3.view
 -rw-rw-r-- 1 couchdb couchdb 6.6M 2011-07-22 08:43 3970d32b6acb424bb4d19684bdf9aff1.view
 -rw-r--r-- 1 couchdb couchdb 51 2011-07-22 08:42 7bbcbf585caef33abc0733282f40a22a.view
 -rw-r--r-- 1 couchdb couchdb 8.6M 2011-07-22 08:43 91188e3c7d61bdf079eee6ca719be05c.view
 -rw-r--r-- 1 couchdb couchdb 1.4G 2011-07-22 08:42 af280ad217f6edca6276d1d1bcbc069d.view
 -rw-rw-r-- 1 couchdb couchdb 573K 2011-07-22 08:43 be708387555557a5b4886292346da6bb.view
 -rw-rw-r-- 1 couchdb couchdb 3.0M 2011-07-22 08:43 d381d1f4b207dc3d9624720a7e88f881.view
 -rw-r--r-- 1 couchdb couchdb 51G 2011-07-22 08:26 fe06cf9119d23dd7fec2492b79e7ebef.view
</code></p>

<p>Well, that was a significant but only partial win. Why do I still have 70GB in .view files?</p>

<p>What Opscode hasn't told us about is that CouchDB has a thing called "Views", and these can - over time - come to take up space. A lot of space. (CouchDB views are the "primary tool used for querying and reporting on CouchDB documents" according to the <a href="http://wiki.apache.org/couchdb/Introduction_to_CouchDB_views">CouchDB Wiki</a>.) Opscode also hadn't mentioned that CouchDB says that these, too, need to be compacted.</p>

<p>The good folks on the internet, notably the CouchDB docs and a question on StackOverflow <a href="http://stackoverflow.com/q/3498856/428779">"CouchDB .view file growing out of control"</a>.</p>

<p>Among our findings we came upon this link to the <a href="http://wiki.apache.org/couchdb/Compaction/#View_compaction">Compaction page in the CouchDB Documentation</a>.</p>

<p>My compatriot Jeff Hagadorn and I were both looking into identifing the design view names, and he beat me to the solution:</p>

<p><code>
bash -c \'for x in checksums clients cookbooks data_bags environments id_map nodes roles sandboxes users; do curl -H "Content-Type: application/json" -X POST http://localhost:5984/chef/_compact/$x ; done\'
</code></p>

<p>(I had found a posting on the couchdbkit Google Group describing a script a user had written to solve this very problem <a href="https://groups.google.com/group/couchdbkit/browse_thread/thread/4bddc28c630d73e0?pli=1">here</a>, if you prefer a Python-based solution which doesn't require you to know your view names.)</p>

<p>After doing that, our disk was in a much healthier state, and our chef-db-compact recipe now looks like this:</p>

<p>```
cron 'Compact Chef DB' do
  user 'nobody'
  weekday '1'
  hour '4'
  minute '0'
  command 'curl -X POST http://localhost:5984/chef/_compact'
end</p>

<p>cron 'Compact Chef Views' do
   user 'nobody'
   weekday '1'
   hour '5'
   minutes '0'
   command 'bash -c 'for x in checksums clients cookbooks data_bags environments id_map nodes roles sandboxes users; do curl -H "Content-Type: application/json" -X POST http://localhost:5984/chef/_compact/$x ; done''
 end
```</p>

<p>which produces a crontab that looks like this:</p>

<p><code>
# Chef Name: Compact Chef DB
 0 4 \* \* 1 curl -X POST http://localhost:5984/chef/_compact
 # Chef Name: Compact Chef Views
 0 5 \* \* 1 bash -c 'for x in checksums clients cookbooks data_bags environments id_map nodes roles sandboxes users; do curl -H "Content-Type: application/json" -X POST http://localhost:5984/chef/_compact/$x ; done'
</code></p>

<p>Now, you may suggest that we mount this location on a separate disk. The answer is that we had. /var/lib/couchdb is a separate 100GB physical disk. The problem was that /var/log is on the / partition, and that is only a 7GB disk. Once the views had filled their disk, the couchdb and chef logfiles had swelled with errors, and even mighty logrotate could only held them off for so long.</p>

<p>Bear in mind that there was no impact to Production during this event; the only outcome was that new changes would not have been able to be pushed out via Chef, and a couple of filled inboxes. Nevertheless, this highlighted some of our flaws. The most important of which is that our monitoring of the server was imperfect, and we missed the alerts that the CouchDB disk was filling. Had we not missed those alerts we could have diagnosed this before it was a problem.</p>

<p>As an aside, in addition to just alerting when disk reaches a certain capacity, you should also watch for sudden increases in utilization. If a particular disk normally runs at 20% capacity, but overnight a logfile swells the disk to 73%, it won't trigger your "75% Full" alert, but there is very likely a problem. One way to solve this is to record a "previous percentage" and compare that to the "current percentage" and alert in the event that there is a sudden increase.</p>

<p>(NOTE: Server Names have been changed to protect the guilty.)</p>

<p>UPDATE: I'm notified by the Senior Systems Admin at Opscode that they have added these compactions to the <a href="https://github.com/opscode/cookbooks/blob/master/chef-server/recipes/default.rb">chef-server recipe</a>. Their implementation is quite a bit different than ours, but no matter.</p>

<p>Harold "Waldo" Grunenwald
 Systems Engineer
 @gwaldo</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Aug 4</div></div><div class="blog-content"><h2><a href="/blog/2011/08/04/play-and-learn/">Play and Learn</a></h2><div class="blog-author">By <strong>Brian Corrigan</strong></div><div class="blog-body"><p>When I was in grade school, I had your typical learning experience. My teacher stood up in front of us everyday and lectured about something that I usually found utterly boring. Fast-forward to college and its still pretty much the same ordeal, except now there are more students. Having said that, you can understand the significant amount of envy that poured from my eyes as I read about the new ways that classes are being taught; one of which is video games. Imagine you went to school excited everyday because calculus was no longer your boring system of numbers and formulas. To add to it, you’ve also sparked a desire to learn because it now becomes a fun challenge. Well that’s the situation with these 6th graders who are learning via the Jason Experiment.</p>

<p>http://www.youtube.com/watch?v=2tB5MQwErzo</p>

<p>Of course, gaming is still dominated by its entertainment persona, but today we’ve seen it evolve and disperse into several different categories. One of these is education. Nowadays, a simple Google search will easily lead you to sites that specialize in this area. We’ve also witnessed it make its way into the mobile phone section and become one of the benchmarks of its category list. Educational gaming has been an aid in the Jason project, which focuses on learning through interactivity. The concept has also been used to support learning of subjects like energy flow or even adult popular subjects like politics or finance. Residing in its early stages of practical, productive use, can you see gaming evolving to become sufficient in other aspects of society?</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jul 29</div></div><div class="blog-content"><h2><a href="/blog/2011/07/29/who-reads-the-manuals/">Who Reads the Manuals?</a></h2><div class="blog-author">By <strong>Leslie Brezslin</strong></div><div class="blog-body"><p>So I recently ordered my own copy of Mortal Kombat and it arrived just a few days ago. Once in my impatient hands, I savagely tore open its containing box without a fragment of mercy; ending with something similar to this:</p>

<p><img alt="" alt="" width="150" height="150" src="/assets/images/uploads/2011/07/wool_box1-150x150-3c9257fa.jpg" /></p>

<p>After that, I proceeded to remove the inferior plastic barrier that stood between me and the future of gory deaths that I’d be responsible for. Having taken care of the plastic with my razor sharp teeth, I pried open the casing open to reveal a fairly well decorated DVD and a booklet on the side. Naturally the booklet never experienced the faintest drop of my attention, but the DVD was pampered with the greatest of care. I removed it from its casing, popped it into my PS3 and enjoyed the awkwardly menacing side of me that enjoyed achieving the bloodiest of fatalities.</p>

<p>Today, with most things, you normally learn as you go along. Somehow, I find myself remembering how I use to value those little booklets that I now show no love to. In the past, before delicately removing the DVD, I would have carefully removed the manual and used it to avoid the learning curve. Now, I realize that it had been a long time since I had read a game manual and will probably be an even longer time before I read another one. So I wonder, are game manuals worth it or have they become a waste of our limited resources? I personally think they should be available on the website or on the game disk. Of course, I haven’t ruled out that I may be the only one who doesn’t care for the manuals, so let me know your thoughts on our <a href="http://www.facebook.com/agoragames">Facebook</a> or below!</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jul 25</div></div><div class="blog-content"><h2><a href="/blog/2011/07/25/gaming-through-the-ages/">Gaming through the ages</a></h2><div class="blog-author">By <strong>Leslie Brezslin</strong></div><div class="blog-body"><p>An overly sized brick that weighed a ton in my hands, comprising of a 2D, black and white screen and some buttons. That’s exactly how the six years old me would have described a Gameboy. Even with its primitive characteristics, the Gameboy is a feature in an evolutionary timeline that started many years before its arrival. If we go back to the beginning of human time, I’m sure that you’d be able to find some relative of gaming regardless of how basic. Competition and play are part of human nature, so whether it was punching wholes in the ground or killing the most mammoths, games can easily be made of anything.</p>

<p>A game is defined as: an amusement, pastime or an activity, which requires skill and is usually some form of competition. Of course, by that definition not many things are subject to exclusion, but a search on Wikipedia or Google nowadays assumes a video game reference. Since man started tracking time, the earliest forms date back to 3000BC, one of which was a simple game of dice. Additionally, they were used then as they are today, as your common pastime for amusement or for competitive/ gambling purposes. Using the Romans as a prime example, they even had what became known as professional gamblers and eventually prohibition laws.</p>

<p>Nowadays gaming has evolved into different categories. These include but are not limited to card games, board games, sports and the popular video games. Video games have also gone as far as merging all categories and changing the way they are experienced. Consider an ancient game like chess for example; it can now be played in a new environment without the physical board. Video games go as far back as the 1940s in early cathode ray tube-based missile defense systems. Originally designed for mainframe computers, videogames later expanded into consoles, personal computers and handhelds.</p>

<p>Today, society has made it hard to fight a gaming addiction because they’re virtually everywhere. Most people have access to computers that undoubtedly hosts them, consoles have gotten cheaper, more affordable and best of all (depending on who you ask), they’ve invaded the mobile phone area. Some of the phone game graphics even rival popular handheld console systems. Hardware in systems is becoming more powerful and will continue to advance as time goes on. Today, we have consoles that offer 3d technology and some as far as virtual reality. I wonder what’s next, brain chips that let your mind be the console, maybe? Anyhow, for those of us that were old enough to enjoy them, I ask which was better, Gameboy, Atari or Game Gear. I personally vote for the Gameboy. Let me know in the comments below or on <a href="http://www.twitter.com/agoragames">twitter</a>.</p>

<p> </p>

<p><img alt="" alt="" width="150" height="150" src="/assets/images/uploads/2011/07/gameboy-150x150-b6ab7804.jpg" /></p>

<p><img alt="" alt="" width="150" height="150" src="/assets/images/uploads/2011/07/gamegear-150x150-acb759ab.jpg" /></p>

<p><img alt="" alt="" width="150" height="150" src="/assets/images/uploads/2011/07/lynx-150x150-e7c33075.jpg" /></p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jul 21</div></div><div class="blog-content"><h2><a href="/blog/2011/07/21/a-new-challenger-appears-videogames-art/">A New Challenger Appears! Videogames &lt;= Art? </a></h2><div class="blog-author">By <strong>Leslie Brezslin</strong></div><div class="blog-body"><p>I've noticed that there are some who hesitate when it comes to positively correlating video games and art.  Of course a statement like there is an art to playing (insert game) is invalid, but what about the finished product itself? This quote “Video games can never be art” by Roger Ebert has me stumped because games are simply hybrids of the art we take for granted everyday. For some, to appreciate a compilation,  one must examine each of the individual parts. To begin, what is art?</p>

<p>Wikipedia describes art as “the expression or application of human creative skill and imagination, typically in a visual form such as painting or sculpture, producing works to be appreciated primarily for their beauty or emotional power”. Although this definition doesn’t go into specifics, there are many mediums through which art (specifically modern art) is experienced. Other than the two mentioned, some of the others include but aren’t limited to music, photography, literacy and motion pictures.</p>

<p>My definition of an artist is a person who creates expressive works through available tools and mediums. Consider a composer, while Mason William's choice was the acoustic guitar, Jimmy Hendrix made a name for himself with the electric guitar.  The question is however, with the broad spectrum of tools that mankind has developed through the centuries, where do we draw the line between what’s art and what’s not?</p>

<p>Painting, a classic art, liberates the trappings of the imagination by providing a platform for recreation and self-expression. Painting has gone from cave walls to the Mona Lisa over the years and below is an example by Johannes Vermeer called “the view of Delft”:</p>

<p><img alt="" alt="" width="300" height="250" src="/assets/images/uploads/2011/07/Vermeer-view-of-delft-300x250-849fff04.jpg" /></p>

<p>Now consider this work from one of the scenes in Brink:</p>

<p><img alt="" alt="" width="300" height="136" src="/assets/images/uploads/2011/07/City-from-brink-300x136-7db70851.jpg" /></p>

<p>This is an artist’s imagination of a world that doesn’t even exist. Regardless of the tools used to create it, the realism and openness to interpretation is at least similar to that of Vermeer. I regard re-creation and imagination as residing on two different planes of creativity. In my opinion, to paint something as it is in front of you isn’t as challenging as painting something as it could be. The interactivity of that world that games allow, tell a story but its brilliance isn’t limited to there. Lets take a motion picture. In this example, we’ll use a scene in a movie that derived from the book “Black Hawk Down” by <em>Mark Bowden.</em>
 http://www.youtube.com/watch?v=iEGSQl9dDG0</p>

<p>Compare this same scene to the popular video game Call of Duty:</p>

<p>http://www.youtube.com/watch?v=D-Kt83WmJec</p>

<p>Will anyone  argue that films aren’t art? Black Hawk Down, won academy awards for its editing and sound; the aesthetics of the film. Undoubtedly, popping in a video you game will bring you very similar characteristics including performances. While Black Hawk Down is an expression of the battle of Mogadishu, COD is a portrayal of World War II. Although subjected to opinion, the only overlaying difference between the two, is the way they are experienced.</p>

<p>They say when you wish to study emotion, you should consult an actor or musician, because it’s the true core of their professions. Music affects the mood and can be found in the background of most if not all films. It helps carry the scene and guide the audience as to how they should be feeling at any point in the plot. In the gaming world, before speech was a norm, music ruled all platforms and represented ninety percent of the sound that would be seen in games (the other ten percent representing the attempts at sound effects). Today, games have grown to feature both.  Some compositions have even grown to become so popular as to ignite re-creations or rearrangements (a feature that was only popular with historic classical pieces or pop music). Take for example the Kingdom Hearts theme song, Dearly Beloved:
 http://www.youtube.com/watch?v=g25QXnhVijQ
 Now compare that simplistic yet beautiful melody to this is composition by Kyle Landry:
 http://www.youtube.com/watch?v=eQ0E3dsHRV4</p>

<p>Like the videos above, a quick search on Youtube bears many results of personalized variations; a growing arena. After all, what is art if not versatile enough to allow you to relate or re-express it as you see it?</p>

<p>As stated by Kellee Santiago in her TED <a href="http://www.youtube.com/watch?v=K9y6MYDSAww">talk</a>, games are the cave paintings of what it can and probably will become. Although I agree that we've only scratched the surface, I think that games aren’t the cave paintings but the evolution of the chicken scratch. It goes further than its predecessors in individualizing the experiences and allowing for a broader range of interpretations. Games are no longer just coded pixels, they're stories, paintings, and compositions. The code only allows them to mobilize and be experienced in a different way than the mediums before it. You can't mix all of the components of art together and disregard the hybrid as something different than its parent class. So are games works of art? yes! if you disagree, let me know in the comments below or on <a href="http://www.twitter.com/agoragames">twitter</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jul 20</div></div><div class="blog-content"><h2><a href="/blog/2011/07/20/a-redis-cache-for-rss-consumption/">A Redis cache for RSS consumption</a></h2><div class="blog-author">By <strong>Logan Koester</strong></div><div class="blog-body"><p>﻿﻿If you’ve ever wanted to include some data from an RSS/Atom feed on a page from Ruby, you’ve probably run into this problem:</p>

<blockquote>
  <p>It’s completely unreasonable to hammer the feed provider with a request every time the page is rendered, but it’s no more reasonable to use a big relational database like MySQL just to cache some stupid tweets or blog posts, especially if your application wouldn’t otherwise need one.
But apparently this layer of persistance has been deemed out-of-scope by the creators of popular RSS consumer libraries such as  <a href="https://github.com/pauldix/feedzirra">Feedzirra</a>.</p>
</blockquote>

<p>So I wrote a little gem called  <a href="https://github.com/logankoester/feedzirra-redis/">feedzirra-redis</a> to take care of this as transparently as possible. You can use it just like you would  <a href="https://github.com/pauldix/feedzirra">Feedzirra</a> normally, but your feeds and entries do not disappear at the end of the script, so you can do the dirty work from a Rakefile via cron instead of in the web request/response cycle while your users impatiently twiddle their thumbs.</p>

<p><strong>Installation</strong></p>

<p>$ gem install feedzirra-redis</p>

<p> </p>

<p>See the  <a href="https://github.com/logankoester/feedzirra-redis/blob/master/README.markdown">README</a> and  <a href="https://github.com/logankoester/feedzirra-redis/blob/master/test/test_feedzirra-redis.rb">test suite</a> for example usage.</p>

<p>Enjoy!</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jul 20</div></div><div class="blog-content"><h2><a href="/blog/2011/07/20/soonatra-coming-soon-pages-on-sinatra/">Soonatra - 'Coming Soon' pages on Sinatra</a></h2><div class="blog-author">By <strong>Logan Koester</strong></div><div class="blog-body"><p>I was recently tasked with creating a “coming soon” page for a new project. The requirements were the usual:</p>

<ul>
  <li>Some description of the project features</li>
  <li>A form to signup for an email list / invites</li>
  <li>Display a few posts from an RSS feed</li>
  <li>Show some screenshots of what we’re building to collect early feedback</li>
</ul>

<p>We've also been increasing our focus on A/B testing (aka "split testing"), so I wanted a way to try out different headlines and see which angle users find most interesting.</p>

<p>This all sounds well and good, but it is very frustrating to take time away from the beginning of an exciting new project to invest in a page that will only be online for a few short weeks.</p>

<p>I decided I don’t ever want to do it again, so I created  <a href="https://github.com/agoragames/soonatra">Soonatra</a>.</p>

<p><a href="https://github.com/agoragames/soonatra">Soonatra</a> is a simple  <a href="http://www.sinatrarb.com/">Sinatra</a>-based framework for creating these pages quickly.</p>

<p><a href="https://github.com/agoragames/soonatra">Soonatra</a> reduces the steps involved to:
- Create a mailing list (we’re using  <a href="http://mailchimp.com/">Mailchimp</a>)
- Choose some colors/graphics that fit well with your brand
- Write the page copy and set an RSS feed url.
- Deploy to a free  <a href="http://heroku.com/">Heroku</a> account and park your domain.</p>

<p>It is easy to extend and manage multiple themes thanks to  <a href="http://compass-style.org/">Compass</a>, and does not require a database, instead using  <a href="http://redis.io/">Redis</a> for RSS feed consumption and tracking A/B test results.</p>

<p>You can fork the git repo and have your site up and running in minutes.</p>

<p>See  <a href="https://github.com/agoragames/soonatra/blob/master/README.textile">README.textile</a> for all the juicy details.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jul 8</div></div><div class="blog-content"><h2><a href="/blog/2011/07/08/1559/">June Recap</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>As June comes to an end, we remember that it brought more to us than the official start of summer. Below is a high level view of just a few of the projects and events that took place this month.</p>

<p><strong>MLG Columbus</strong>
 Lets start off with our biggest event, MLG Columbus. This month’s Pro circuit was held during the weekend of June 3-5 in Columbus Ohio and obtained notable success. Throughout the weekend, nearly 15 thousand people showed up to support their favorite gamers. That however, was nothing near the 22.5 million people who streamed the event from their computers. With the major updates we made to our systems, we formulated the equation for a very successful pro circuit event that tromped the ones before it.</p>

<p>﻿<strong>Git</strong></p>

<p>This month we added a few new goodies to our Github portfolio accessible at github.com/agoragames. Some of which include:</p>

<p><a href="https://github.com/agoragames/haigha"><strong>Haigha</strong></a></p>

<p>Haigha provides a simple to use client library for interacting with AMQP brokers. It currently supports the 0.9.1 protocol and is integration tested against the latest RabbitMQ 2.4.1 (see <a href="http://dev.rabbitmq.com/wiki/Amqp091Errata">errata</a>). Haigha is a descendant of py-amqplib and owes much to its developers.</p>

<p>The goals of haigha are performance, simplicity, and adherence to the form and function of the AMQP protocol. It adds a few useful features, such as the ChannelPool class and Channel.publish_synchronous, to ease use of powerful features in real-world applications.</p>

<p>By default, Haigha operates in a completely asynchronous mode, relying on callbacks to notify application code of responses from the broker. Where applicable, nowait defaults to True. The application code is welcome to call a series of methods, and Haigha will manage the stack and synchronous handshakes in the event loop.</p>

<p><a href="https://github.com/agoragames/gondola"><strong>Gondola</strong></a></p>

<p>Gondola is a ruby gem which aims to bridge the gap between two very prominent, open source, quality assurance tools, Selenium IDE and Sauce Labs. Many quality assurance professionals who don't have the necessary technical skills to write Selenium webdriver-based unit tests prefer to do their web regression testing using solely the Selenium IDE and then exporting those test cases by some means to Sauce Labs' system.</p>

<p>Gondola offers an easier and more convenient system for dispatching tests written in Selenium IDE to a Sauce Labs account. Gondola transforms the html that Selenium IDE produces by default and ships it to Sauce Labs across a number of browsers in parallel. Test suites and projects can be easily organized with simple file directory structures.</p>

<p>Beyond the console application that comes with the gem, Gondola offers a small API for integrating Gondola's features into custom web apps. This allows a user to bring Gondola's simplicity into an existing testing suite or a new web application. Specifically, we have a plan to write a sample Gondola web app to demonstrate its power.</p>

<p>We’ve also added updates to the projects that were the deliverables of previous months. Check out the Git page for a full list.</p>

<p><strong>Webby Awards</strong></p>

<p>The Webby Award is the leading international award honoring excellence on the Internet. This year we won two webby awards, one for lifestyle and another for the other for games.</p>

<p><strong>Mortal Kombat Fight Stick</strong></p>

<p>This classic trophy is a gift from Warner Bros for the work that we did on the latest Mortal Kombat game. Currently, we are powering the stats on their website and are responsible for the creation of their in-game chat features.</p>

<p><a href="http://tv.majorleaguegaming.com"><strong>MLG.tv</strong></a></p>

<p>So MLG.tv has received numerous updates and features over the course of this month. One of those, is the user generated content feature with options such as SSO/login integration_, _video uploads, user channels and a user videos page. We’ve also added video rating and moderation capabilities along with several addition improvements on the back end of the site.</p>

<p><strong>MLG Store</strong></p>

<p>There have been quite a few updates deployed to the MLG store, making it simple and enjoyable to get the things you want. We’ve also heightened security in order to protect your information and prevent fraud while fostering a painless checkout process.</p>

<p>These are just six of the things that went on during the sixth month of the year. Here at Agora we’re constantly working and implementing new back-end and front-end updates. Thank you to the team for a productive month and to you our followers for your support. For more detailed and on the spot update information, follow us on <a href="http://twitter.com/agoragames">Twitter</a>, <a href="http://www.facebook.com/agoragames">Facebook</a> and <a href="http://www.github.com/agoragames">Github</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 27</div></div><div class="blog-content"><h2><a href="/blog/2011/06/27/nerds-the-take-over/">Nerds: The Take Over</a></h2><div class="blog-author">By <strong>Brian Corrigan</strong></div><div class="blog-body"><p>Several days ago, I was walking with my Agora Games t-shirt, which happens to bare the Major League Gaming (MLG) logo on the arm. Out of Dunkin Donuts, a young boy excitedly ran up to me. After catching his breath, he goes, “excuse me, do you compete in the MLG?” At that point I had gotten towed and was on the phone with the police so I simply shook my head no.</p>

<p>Think back to high school; remember the assortment of social groups? To name a few, we had the jocks with expectations of college sports and the major leagues. Also, we had the dramatic arts students who hoped for the big break that would land them fame and fortune. There’s no forgetting the music students who dreamed of being rap or rock stars and finally, the nerds. Sadly there was no glamorous expectation for the nerds. They were expected to do your normal jobs, working for big companies or starting their own.</p>

<p>Even when you considered the earning potential, there was still that essence of glory that was missing, unless you discovered something great. This however, started to change about eight years ago when Sundance started MLG. Today MLG is accurately described as a huge concert for gamers. The last event housed almost 15,000 while streaming to an audience of at least 22.5 million.</p>

<p>After getting my car, I started thinking of the influence that MLG has on the new generation. To young kids, MLG is right up there with other professional leagues such as the NBA or the NFL. MLG already opens doors to huge opportunities for sponsorships and endorsement deals and will only go further. Additionally, as we attract more sponsors and fans, the growth potential becomes unlimited.</p>

<p>Now consider the change that brings to that same high school scene. Finally, a means of recognition for those who lack the interest or ability to play sports, act out a scene or please a crowd with music. Now when you’re told to do something for your future, it’s arguable that you are investing in your future. So, to those siting on the couch pwning their friends in Halo, your path to glory awaits.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 24</div></div><div class="blog-content"><h2><a href="/blog/2011/06/24/of-penguins-rabbits-and-buses/">Of Penguins, Rabbits and Buses</a></h2><div class="blog-author">By <strong>Aaron Westendorf</strong></div><div class="blog-body"><p>Here at Agora we make use of dedicated hardware and virtual machines running on our providers' respective clouds. In recent months, we've moved our RabbitMQ hosts onto hardware because we found that we could far exceed the CPU capacity of our virtual machines and it was far cheaper to run a small cluster of hardware hosts than a giant cluster of VMs. We used an existing, underutilized host for our primary traffic while awaiting delivery and installation of a new pair servers. Expecting a simple plug-and-play swap, I set out to test the new hardware before we made the transition. What follows is a harrowing tale into the deepest depths of modern hardware architecture.</p>

<p>Our current primary RabbitMQ host, leviathan, is a 24 core Intel Xeon X5650 running at 2.67GHz and fitted with 132GB of RAM. The machine hosts all our in-memory databases, such as Redis and Memcached, and is vastly underutilized at this time. RabbitMQ is run in a cluster with other nodes hosted on VMs to give us failover capacity.</p>

<p>To replace its role as RabbitMQ host, we purchased artemis and hermes, two 24 core AMD Opteron 6172s running at 2.1GHz and fitted with 8GB of RAM each. Recent versions of RabbitMQ page queue backlogs to disk, and our traffic pattern and infrastructure validations are such that this amount or RAM is sufficient.</p>

<p>At first, one might assume that the differences in processors would result in near-equal <a href="http://www.bit-tech.net/hardware/cpus/2010/03/31/amd-opteron-6174-vs-intel-xeon-x5650-review/1">performance</a> for RabbitMQ. The Intel CPUs have faster clock cycles, but they rely on Hyper-Threading to present 24 logical cores to the operating system. The AMD CPUs are slower, but they present 24 hardware cores to the kernel. <a href="http://www.centos.org/docs/5/html/5.2/Deployment_Guide/s2-proc-cpuinfo.html">Linux</a> reports 5333 bogomips for the Xeons, 4200 for the Opterons.</p>

<p>Using <a href="https://github.com/agoragames/haigha">haigha</a>'s load testing <a href="https://github.com/agoragames/haigha/blob/master/scripts/stress_test">script</a>, we were astonished to discover that our brand-new hardware was almost 50% slower than our until-recently-brand-new Intel hardware! What could possibly have gone wrong?</p>

<p>The test that we ran consisted of 3 VM clients, each with 4 cores, each running 3 instances of the standard configuration of the <code>stress_test</code> script of 500 channels looping messages over 500 queues. That is, 4500 channels and queues, each channel publishing a message as soon as it receives its previously published message. The test would run for a fixed period of time, usually a minute.</p>

<p>Our investigation started simple enough. Using top and our new favorite, htop, we observed that the kernel was using a substantial portion of each cores capacity. We also observed that cores were underutilized, as htop clearly showed a visible gap on the right-hand side the CPU graphs. Though not scientific, it appeared to be a 10-30% loss. A bit of <a href="http://www.theregister.co.uk/2010/04/20/ubuntu_server_10_04/">research</a> implied that the Ubuntu 10.04.2 kernel, 2.6.32, was perhaps released around the same time as our AMD chips, and may not fully support them. We tested the latest patches to that release, 2.6.32-32, but did not observe any improvement.</p>

<p>Venturing into unknown territory, we installed the latest kernel backported from maverick, 2.6.35-25. We immediately observed an improvement in CPU usage, such that all cores were near 100% utilization. Sadly though, our message throughput remained nearly the same, as user space consumed only 40% of each core. Yet when comparing a single instance of <code>stress_test</code> , leviathan and artemis performed nearly equal. In no case were we able to induce any IO wait, which was to be expected since we weren't hitting disk. Why would 24 cores of AMD be so dramatically different than 24 cores of Intel?</p>

<p>With the obvious problems ruled out and the latest kernel installed, I started to dig deeper into the architectural differences between the two companies' designs. Using <a href="http://manpages.ubuntu.com/manpages/natty/man1/lscpu.1.html">lscpu</a>, we can see two very different CPU designs.</p>

<p>```
 leviathan:~$ lscpu
 Architecture: x86_64
 CPU op-mode(s): 32-bit, 64-bit
 CPU(s): 24
 Thread(s) per core: 2
 Core(s) per socket: 6
 CPU socket(s): 2
 NUMA node(s): 2
 Vendor ID: GenuineIntel
 CPU family: 6
 Model: 44
 Stepping: 2
 CPU MHz: 2666.806
 Virtualization: VT-x
 L1d cache: 32K
 L1i cache: 32K
 L2 cache: 256K
 L3 cache: 12288K</p>

<p>artemis:~$ lscpu
 Architecture: x86_64
 CPU op-mode(s): 64-bit
 CPU(s): 24
 Thread(s) per core: 1
 Core(s) per socket: 12
 CPU socket(s): 2
 NUMA node(s): 4
 Vendor ID: AuthenticAMD
 CPU family: 16
 Model: 9
 Stepping: 1
 CPU MHz: 2100.172
 Virtualization: AMD-V
 L1d cache: 64K
 L1i cache: 64K
 L2 cache: 512K
 L3 cache: 5118K
```</p>

<p>The AMD CPUs have nearly double the amount of dedicated cache per core, but a much smaller (shared) L3 cache. Though this was clearly a fundamental difference, it did not seem adequate in explaining the vast amount of time that the kernel was consuming on each CPU. Yet the only reason why the kernel would be consuming so much time, without any IO wait, would be if it was waiting for something. What would Linux be waiting for that Intel was readily delivering?</p>

<p>As I noted, our test was running 4500 unique channels and queues. In a <a href="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-May/012991.html">reply</a> to a recent inquiry on the RabbitMQ mailing list, I learned that both channels and queues are allocated an Erlang process. A bit of searching and I found a useful <a href="http://www.erlang.org/euc/08/euc_smp.pdf">paper</a>[PDF] on the early SMP support in Erlang R12B, circa 2008. The diagrams show a single run queue from which all schedulers pull the next process to run.</p>

<p>By R13B, each scheduler had a <a href="http://www.erlang.org/documentation/doc-5.7/doc/highlights.html">dedicated</a> run queue, vastly decreasing lock contention. Additionally, scheduling algorithms, and <a href="http://www.erlang.org/doc/man/erlang.html#system_flag-2">configuration thereof</a>, were designed specifically to take advantage of the variety of SMP architectures. RabbitMQ is running on R14B01, and so it should have the latest in SMP optimizations, particularly with respect to <a href="http://en.wikipedia.org/wiki/Non-Uniform_Memory_Access">NUMA</a>, which is how both Intel and AMD implement their SMP architectures.</p>

<p>Linux is also NUMA-aware, and contains scheduling algorithms that try to pair the core that a process or thread will use with the NUMA node where its memory is allocated. Likewise, it tries to allocate memory on the same NUMA node as the process or thread that is requesting it. This was a topic area we were already familiar with, but in terms of <a href="http://jcole.us/blog/archives/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/">database applications</a> that consume most of system RAM. That clearly was not the case here, as RabbitMQ barely consumed 500MB under the stress test, and the memory is allocated on demand, and so was spread evenly across all NUMA nodes.</p>

<p>So with hardware that benchmarked well, using recent releases of the Linux kernel and Erlang VM, and an application that used a small fraction of available RAM, RabbitMQ performed abysmally slow. What could possibly cause such behavior?</p>

<p>The final piece of the puzzle lay in the nature of RabbitMQ itself. Though Erlang may try to pair a process with a node-bound scheduler, and Linux allocate memory on the same node as that scheduler, that's of little use in practice. When a message is read from a connection (itself a process) on a channel (also a process), the route of that message must be looked up in an mnesia-backed global table to determine which queue(s) the message should be copied to. Bits are allocated and written to for that queue (yet another process), and then any consumer of that queue - a channel - must read the bits before sending them out. In short, there is a near-0 chance that the bits necessary to fulfill a single publish-route-consume will be processed by the same scheduler, and a just-slightly-greater-than-0 chance that it will be processed by a scheduler on the same NUMA node. Even if the code is optimized to only copy messages as references, numerous reads and writes must acquire an exclusive lock on a NUMA nodes memory bus.</p>

<p>So what's the difference between Intel and AMD NUMA implementations?</p>

<p>```
 leviathan:~$ numactl -H
 available: 2 nodes (0-1)
 node 0 cpus: 0 2 4 6 8 10 12 14 16 18 20 22
 node 0 size: 65525 MB
 node 0 free: 59013 MB
 node 1 cpus: 1 3 5 7 9 11 13 15 17 19 21 23
 node 1 size: 65535 MB
 node 1 free: 59787 MB
 node distances:
 node 0 1
 0: 10 20
 1: 20 10</p>

<p>artemis:~$ numactl -H
 available: 4 nodes (0-3)
 node 0 cpus: 0 2 4 6 8 10
 node 0 size: 2047 MB
 node 0 free: 1621 MB
 node 1 cpus: 12 14 16 18 20 22
 node 1 size: 2044 MB
 node 1 free: 1758 MB
 node 2 cpus: 13 15 17 19 21 23
 node 2 size: 2048 MB
 node 2 free: 1806 MB
 node 3 cpus: 1 3 5 7 9 11
 node 3 size: 2047 MB
 node 3 free: 1874 MB
 node distances:
 node 0 1 2 3
 0: 10 20 20 20
 1: 20 10 20 20
 2: 20 20 10 20
 3: 20 20 20 10
```</p>

<p>The AMD cores are split across four nodes, whereas the Intel cores only use two. In the case where a process uses all cores equally, there is a 50% probability of a memory operation being local on a Xeon processor, but only a 25% probability on an Opteron!</p>

<p>Starting RabbitMQ on just 2 nodes, I instantly gained nearly 30% improvement, using half the available processing power, and kernel time dropped to a far more normal 20-30% per core. I experimented with this for a few hours, and found that 3 nodes, with memory interleave across all 4 nodes, was the optimal configuration. But what of the Erlang scheduler?</p>

<p>```
 artemis:~$ erl
 Erlang R14B01 (erts-5.8.2) [source] [64-bit] [smp:24:24] [rq:24] [async-threads:0] [hipe] [kernel-poll:false]</p>

<p>Eshell V5.8.2 (abort with ^G)
 1&gt; erlang:system_info(scheduler_bind_type).
 thread_no_node_processor_spread
```</p>

<p>Erlang is smart enough to recognize that this is a NUMA system, but the scant documentation implies that the default scheduler type is best suited to to Hyper-Threading architectures. As it turns out though, all of the scheduler types that are documented as designed for NUMA were slower than the simple <code>processor_spread</code> scheduler, which out-performed the NUMA schedulers by almost 30%. And what of the number of schedulers and <a href="http://stackoverflow.com/questions/1182025/what-do-the-erlang-emulator-info-statements-mean">request queues</a>? Though they're configured for 24 cores, experiments show that the default number of 24 is best, even given only 18 cores of execution. I can't speak to why exactly either of these two settings are best, but I can entertain any number of educated guesses.</p>

<p>The last question that remained was, if we're to run with 3 out of 4 NUMA nodes, which ones do we choose? It seemed logical to pick the ones that weren't connected directly to the network card, the only other bit of hardware which we were trying to push as many bits through as possible.</p>

<p>```
 artemis:~$ lspci -tv
 -[0000:00]-+-00.0 ATI Technologies Inc RD890 Northbridge only dual slot (2x16) PCI-e GFX Hydra part
 +-04.0-[0000:04]–+-00.0 Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet
 | -00.1 Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet
 +-06.0-[0000:05]–+-00.0 Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet
 | -00.1 Broadcom Corporation NetXtreme II BCM5709 Gigabit Ethernet
 ………………….</p>

<p>artemis:~$ ifconfig
 eth1 Link encap:Ethernet HWaddr aa:aa:aa:aa:aa:aa
 inet addr:111.111.111.111 Bcast:111.111.111.111 Mask:255.255.255.255
 inet6 addr: ffff::ffff:ffff:ffff:ffff/64 Scope:Link
 UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
 RX packets:71583284 errors:0 dropped:0 overruns:0 frame:0
 TX packets:134508244 errors:0 dropped:0 overruns:0 carrier:0
 collisions:0 txqueuelen:1000
 RX bytes:13852822249 (13.8 GB) TX bytes:23156900853 (23.1 GB)
 Interrupt:45 Memory:f4000000-f4012800</p>

<p>artemis:~$ cat /sys/bus/pci/devices/0000:04:00.1/irq
 45</p>

<p>artemis:~$ cat /sys/bus/pci/devices/0000:04:00.1/numa_node
 0
```</p>

<p>It's unclear how much of a difference that makes, but when RabbitMQ is under full load, a few of the cores on node 0 show 5-30% kernel usage, a mixture of network card and memory traffic.</p>

<p>Our final configuration looks something like this. Your installation will have these stanzas in various places depending on the distribution and how your administrator configured the runtime scripts. Note that we turned off <a href="http://www.erlang-solutions.com/thesis/tcp_optimisation/tcp_optimisation.html">async threads</a>. We didn't observe any benefit of enabling them, and it was unclear if they degraded performance.</p>

<p><code>
 SERVER_ERL_ARGS="+K true +sbtps +P 10485760"
 exec setuidgid rabbitmq numactl --cpunodebind=!0 /usr/local/sbin/rabbitmq-server
</code></p>

<p>The final result? Using only 18 AMD cores of execution, artemis achieved 93% of the performance of leviathans 24 Intel cores. Given that Linux calculated a 22% performance difference, we'll call that a win. Who can complain about two hosts capable of 40,000 messages each vs. a single host capable of 43,000?</p>

<p>What can we learn from this? Firstly, know the hardware you're buying. No matter how this played out, the Intel chips benchmarked faster, and we should have stuck with those when purchasing our RabbitMQ hosts. Second, the physical layout of the data path and the nature of your application together determine the bounds of your capacity. <em>Any</em> multithreaded application configured to use all of your cores, where the memory access pattern is not localized to a single thread, will exhibit <em>non-linear</em> performance inversely proportional to the number of NUMA nodes those threads run on.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 23</div></div><div class="blog-content"><h2><a href="/blog/2011/06/23/hero-or-villain/">Hero or Villain?</a></h2><div class="blog-author">By <strong>Leslie Brezslin</strong></div><div class="blog-body"><p>When we play video games, we are automatically transported into a world that stretches beyond the line of current reality. Within this world, you are granted complete freedom while omitting consequences. Many people play games because it’s a channel through which we can live out the impossible. While there are many other reasons, I question whether our attention spans are the only things being is injected into the games we play.</p>

<p>Today, many games offer the ability to play as either a good or evil character. For me, the evil character is usually more appealing. The reason is simply because I know it’s fake. I figure, hey; if you’re going to enter a fictional world, why enter as yourself? Why enter just to follow the laws and moral code of the current realm that you’re trying to escape?</p>

<p>I was curious as to see what the general consensus on the matter was, so I asked around. The answer to the question wasn’t very surprising at all. It seems like the majority of people (at least here at the office) enter gaming worlds as heroes serving the laws of “good” and fighting for justice. Some people claimed to enjoy the feeling of cleaning up the crap in this world while others did it for the honor. Those who chose the villain were those who only cared about an entertaining storyline. I however, have my own theory on the matter.</p>

<p>For many people, playing games does not eliminate the sense of morality and duty to the world’s wellbeing that we’ve been encoded to uphold. We perceive what goes on in games, as we perceive ourselves in those situations. Some of us even go as far as to subconsciously apply methods like Karma to those situations. Our moral codes enter the game along with our attention spans and we block ourselves from completely enjoying the total package.</p>

<p>So, what’s the lesson to be learned? Next time you turn on a video game, escape yourself. Forget the world on your shoulders and do as you see fit. If the color of the houses annoys you, burn down the village. You have ample time to spend as a good person in the real world.</p>

<p>Perfect Example right here —&gt; http://kotaku.com/5815150/saints-row-the-third-revels-in-the-absurd</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 22</div></div><div class="blog-content"><h2><a href="/blog/2011/06/22/secrets-to-success/">Secrets to success</a></h2><div class="blog-author">By <strong>Mike DelPrete</strong></div><div class="blog-body"><p>Success pertains to anyone willing to grab it, however, the majority will experience it through different channels. A lot of people measure success by a person’s current status; what they have, who they know and ultimately where they are. Only, is this a correct scale upon which to measure a person’s triumphs? When measuring success, should you look at the point where a person has landed or consider the journey from where they made the initial jump?</p>

<p>Personally, I prefer to look at the whole picture as opposed to one part of it. The fact of the matter is, although all men were created equal, not all were born with the same opportunities. Ultimately, we have the potential to reach the highest form of glory as well as the lowest. That’s why my measure of success is based on analyzing the whole path that a person has traveled. Someone starting at a lower position has a lot more work to put in, but can eventually reach the highest outcome.</p>

<p>The world has many opportunities to offer and many are determined enough to recognize them. One example of this is Mike DelPrete, the CEO of Agora Games. Mike started Agora Games eight years ago and it thrived both before and after it’s acquisition by MLG. When I asked Mike what the secret to his success was, he told me to ”get back to work.” Idealistically, I took that for stay focused and continue with the task at hand. After surviving his ocean of emails, meetings and conferences, Mike specified “hard work, determination, and having an open mind.”</p>

<p>The pillars of success reside on the platform of determination. Needless to say, that platform isn’t leveled. This is one of the leading causes of the gap between those who prosper and those who fall behind. The result that you can expect to gain from any experience is positively correlated to the sacrifices that you’re willing to make. Of course some dream bigger than others, but many fail to make it through the first stage: desire. Without a constant desire for something greater, can you expect progress?</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 21</div></div><div class="blog-content"><h2><a href="/blog/2011/06/21/introducing-haigha/">Introducing Haigha</a></h2><div class="blog-author">By <strong>Aaron Westendorf</strong></div><div class="blog-body"><p>We're pleased to announce the official release of haigha, our Python AMQP client library.</p>

<p>Haigha is the culmination of over 2 years of development. We've used RabbitMQ since we launched our <a href="http://blog.agoragames.com/blog/2010/06/28/lifting-the-tail-inside-agora-skunk-works/">game services platform</a> and immediately fell in love with it and the power that AMQP afforded us. At the time that we began development, py-amqplib was the dominant client library. It fully-supported the 0.8.1 protocol features we made use of, but because it was blocking, fell short of our desire for an asynchronous, highly-scalable messaging layer on which to build our services. At the time, only <a href="https://launchpad.net/txamqp">txAMQP</a> supported asynchronous IO and we had ruled out Twisted for a variety of reasons. Pika, the official Python client maintained by RabbitMQ, had yet to be <a href="https://github.com/pika/pika/commit/d514dce7daf10cfc727cca9095ef0d114f9e4592">born</a>.</p>

<p>With the py-amqplib source in hand, we deployed it directly into our stack and started heavily modifying it to integrate <a href="http://code.google.com/p/pyevent/">pyevent</a>. By mid-2009 we had a stable and fast fork of py-amqplib and were able to scale our HTTP&lt;&gt;AMQP bridge to tens of thousands of concurrent connections. As these things are wont to go, once we had met our needs, and our schedules demanded focus on client deliverables, our fork languished, unknown to the world and quietly shuffling gigabytes of data across our network.</p>

<p>Throughout 2010 we continually expressed a desire to release what we had done to the community at large, feeling that others could also benefit from a fast asynchronous AMQP client for their Python applications. Pika was maturing rapidly and interest was clearly growing for building the kind of applications that AMQP can support. We held out releasing anything, as the changes we had made to support event-driven IO had brought to light many problems in the layout of py-amqlib, and our fork was based on an older version of the code, before a major refactor. We felt that a ground-up re-write, with a clean and efficient architecture, was the right way to contribute back to the community and improve our own code base.</p>

<p>In the dark pre-dawn hours of Friday 24 September 2010, haigha was <a href="https://github.com/agoragames/haigha/commit/2a4f63ddc08140f4078c396d32021256ad55762d">born</a> during the 2nd Agora Games hack-a-thon. By the <a href="https://github.com/agoragames/haigha/commit/36aad0cca6686d871fe0c8923eb460de743b2504">end</a> of the day we had a working demo with architectural details in place, and continued to develop features for the next few weeks before once again putting it on hold in favor of money-making enterprises.</p>

<p>After a restful New Year vacation, we spent several weeks completing haigha, profiling and optimizing it, and integrating it into our game services stack. The transition was seamless, about the best anyone could ask given that a major component we rely upon was completely re-written and deployed against a major upgrade to RabbitMQ, as we transitioned from the 1.7 series to the 2.2 series and the 0.9.1 protocol.</p>

<p>We still felt it poor form to release without comprehensive unit tests, and momentum was building to throw away <a href="http://code.google.com/p/pymox/">pymox</a> in favor of a new <a href="http://mocha.rubyforge.org/">Mocha</a>-inspired mocking library. In another pre-dawn fit of hack-a-thon inspiration, we launched <a href="https://github.com/agoragames/chai">Chai</a>. With the right tool for the job in hand, we set about completing our unit test suite.</p>

<p>Once again, <a href="http://www.themortalkombat.com/">client deliverables</a> conspired to keep our code from finally seeing the light of day, but after the big crunch, we punched through a <a href="http://blog.agoragames.com/blog/2011/05/19/the-haigha-preview/">quietly-publicized</a> <a href="http://lists.rabbitmq.com/pipermail/rabbitmq-discuss/2011-May/012861.html">preview release</a>.</p>

<p>After a few more weeks baking in the oven, we've nearly completed code coverage, fixed many bugs, and generally cleaned house. We feel that haigha is now ready for the masses, and we're proud to put it out there for the rest of the community to use. We look forward to your <a href="https://github.com/agoragames/haigha/issues">feedback</a>. You can find the source on <a href="https://github.com/agoragames/haigha">github</a> and packages on <a href="http://pypi.python.org/pypi/haigha">pypi</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 16</div></div><div class="blog-content"><h2><a href="/blog/2011/06/16/the-postman-always-rings-twice/">The Postman Always Rings Twice</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>My colleague <a href="https://twitter.com/#!/logankoester">@logankoester</a> posed the following question in our team chat room: "Can the Github bot notify HipChat on wiki updates as well? I mean, wikis are just git repos, right? I am equally interested in documentation changes as in software changes."</p>

<p>It is possible to do this in a little bit of a roundabout way. Read on to see how I did this with <a href="http://hudson-ci.org/">Hudson</a>, our Continuous Integration server.</p>

<ul>
  <li>
    <p>We have the <a href="https://github.com/jlewallen/jenkins-hipchat-plugin">Jenkins HipChat plugin</a> installed and configured in Hudson.</p>
  </li>
  <li>
    <p>Grab the Wiki Git Access URL for your project, e.g. git@github.com:myorganization/my-project.wiki.git</p>
  </li>
  <li>
    <p>Create a new project in Hudson to monitor the project's Wiki Git repository. Relevant items to setup in the project would be as follows:</p>
  </li>
</ul>

<p>Project name: Identify in the project name that it is the Wiki for your project so as to not be confused with actual project software notifications.</p>

<p>Source code management: Set to git and use the Wiki Git Access URL for your project here.</p>

<p>Branches to build: **</p>

<p>Poll SCM: I set to check every 30 minutes. Example:</p>

<p>*/30 * * * *</p>

<p>In the Post-build actions: check the box for HipChat notification and set the name of the room to the one where notifications on Wiki changes should be sent to.</p>

<p>And you're done! If there are no changes to the wiki since the last poll, you won't get any notices from Hudson. If there are changes to the wiki since the last poll, a notification will be posted to HipChat. Folks can then click the link in Hudson to see the list of changes.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">@CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 13</div></div><div class="blog-content"><h2><a href="/blog/2011/06/13/agorian-survival-new-employee-edition/">Agorian Survival: New employee edition</a></h2><div class="blog-author">By <strong>An Intern</strong></div><div class="blog-body"><p>Around this time last year, I was preparing to return to my internship with a fortune 50 company. However, the excitement that normally comes with such an accomplishment escaped me. The reason is because I knew exactly what to expect. I’d dress up in typical business attire and sit at my desk from 9-5, while waiting for the occasional computer crash or random fire drill. With so much to look forward to, who could complain, right?</p>

<p>Wrong. When my last day came, I decided that I had officially retired the repetition, stress and boredom. After putting my best foot forward, I landed a job at Agora Games and things were completely different. I seemed to have entered an unfamiliar world, full of fun and exciting individuals with no limit to their creative potential. The plethora of randomness and the nature of our work, combined with the flexibility and surreal environment, formulated a culture that removed the work out of the job.</p>

<p>On your first day at Agora, you will be set up at a new computer with a standard four-legged chair. I mention the chair’s regularity because it is then your prerogative to choose a new one from Staples. Your first course of action however, is to tour around the office for a company-wide meet and greet. Of course, no one expects that you’ll remember their name. Down the line, people will generally re-introduce themselves and try to get to know the family’s new addition.</p>

<p>Like many, I place high value on self-expression. With that, I can proudly say that one of the biggest perks you’ll find at Agora is freedom.  This isn’t a bureaucratic work environment where you’ll get sanctioned for forgetting to tuck in your shirt.  Whether you want to dress like Prince or the old school New York Knicks players is up to you.</p>

<p>Expect to find the necessary hierarchies and team divisions, which keep us organized and successful but you won’t be able to tell who’s who. Just yesterday a few of us went for ice cream with the CEO. We’re well structured which leads us to power projects like Guitar Hero, Call of Duty, or Mortal Kombat but at the same time, perfectly balanced to produce happier, more driven employees.</p>

<p>To conclude this rant, I have a lot to look forward to and a lot to learn, but I also have an array of exciting individuals to learn from.  Additionally, with the constant stream of new challenges that keep me enticed, I couldn’t have chosen a better place to work.</p>

<p> </p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 9</div></div><div class="blog-content"><h2><a href="/blog/2011/06/09/the-friendly-point/">The Friendly Point</a></h2><div class="blog-author">By <strong>Blake Taylor</strong></div><div class="blog-body"><p>Do you use points or do you use pixels? I've fallen in love with points. If you know me, you might already know this because I talk about them all the time. So what is it that I like about points, or perhaps, what is it that I dislike about pixels?</p>

<p>First off, did you know that a pixel isn't actually a pixel? As it turns out, what we refer to as a pixel nowadays, is more accurately defined as a device independent pixel, also known as a kludge. Consider this, you’re a developer, 10 years back, listening to bootylicious while styling with your bowl haircut. You’re probably specifying things in pixels with the assumption that monitors will never have more than the cutting edge 96ppi. Now fast-forward to present day with our 400 some odd pixel iPhone displays and consider how compressed that same page looks. Displays may be increasing in resolution, but our eyes aren’t. Additionally, we can't let our pixel-based designs shrink as resolution increases, so we what do we do? We redefine the pixel to the critical measure of 1/96 of an inch.</p>

<p>Interestingly enough, this measure does have magical properties of it's own. However, it’s a system that seems to be rooted in happenstance, so I feel a little dirty about using it without considering anything more. The point system, on the other hand, not only doesn't suffer from this shameful introduction, but hell, there's elegance in its history.</p>

<p>The point (pt) goes way back and has a helpful cousin, the pica, with its own special abilities. So why do you think those crazy typesetters and print practitioners choose the point and the pica even to this day? I would certainly propose flexibility as the reason. 1 pixel is equivalent to 1/96 of an inch, what the hell does that mean? Now, consider 1/72 of an inch and we're getting into the territory where I might actually recognize the difference of a single unit. We're all familiar with 12pt font, there's also 11, 10, 9, and 8. It’s simple enough, pick a font above 7 and you’ll be able to read it. What about 32pt? That's headline font in the print world. Guess what, there's no reason why it can't be used in the web world as well. It's just that we realize we're moving bits around and not ink, so we use relative measures such as the em for fonts, but it should all still be rooted in the friendly point.</p>

<p>So what's a pica? Well a pica is 1/6 of an inch. 6, huh, well that's a nice number. Half of that is 3. I like 3. Get this, if there's 6 pica in an inch and there's 72 points in an inch, then that means there's 12 points in pica. 12, now that's an awesome number. It's evenly divisible by 2, 3, and 4. How many numbers can you say that about? I'm sure the answer is infinite, but now you’re just being a jerk and you’re missing my point. 12 is cool, 6 is cool, 3 is cool, 1.5 is cool, .75 is cool even .375 is manageable. Let's go the other way. 24 = 2pc, 48 = 4pc, 96 = 8pc. There's that damn number again.</p>

<p>Anyway, what's my point? (No pun intended) Use points. They're there and they're not fugly. Converting pixels into points is easy, just multiply by .75. Also, since it’s rooted in what's made print look good for years rather then what the state of the art was when CSS became popular, the numbers just tend to work out nicer. Give em a try (haha, another pun); what do you have to lose?</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 7</div></div><div class="blog-content"><h2><a href="/blog/2011/06/07/did-you-miss-mlg-columbus/">Did you miss MLG Columbus?</a></h2><div class="blog-author">By <strong>Brian Corrigan</strong></div><div class="blog-body"><p>This weekend, MLG held a highly competitive, highly anticipated competition to test the strengths of pro gamers alike. The Pro Circuit, this time in Columbus, Ohio, included a number of competitors facing off for champion status in StarCraft 2, Halo: Reach and Call of Duty: Black Ops.  The three-day event concluded as follows:</p>

<p><strong>StarCraft 2</strong></p>

<p>SlayerSMMA, the “Terran” prodigy, defeated second place winner IMLosira in the finals with a four to one win. MMA didn’t lose a single series all weekend and only dropped two games in total. Entering game four with a two-to-one lead, MMA survived massive Roach/Baneling attacks and executed excellent drop plays to shut Losira down. In game five, MMA deployed early reapers to kill off Losira’s drones. He eventually followed up with a big Marine/Tank force to force the surrender.</p>

<p><strong>Halo:</strong> Reach</p>

<p>Dropping just one map, team Instinct, consisting of Ogre 2, Roy, Lunchbox and Pistola, were crowned MLG Columbus Halo champions. Instinct left with an amazing record of 21:1 after having defeated second place winner Str8 Rippin. It wasn’t until facing third place winners Dynasty in the WB final that they dropped a game. That however didn’t faze the team as they continued on to win the match and dominate the tournament.</p>

<p><strong>Call of Duty:</strong> Black Ops</p>

<p>MLG Columbus produced a surprising sequence of events during the Call of Duty match ups. As day three continued, some of the highly favored teams fell into the losers bracket and the finals ended in an unexpected sweep. Optic Gaming was the victor who claimed the Black Ops Pro Circuit trophy.  Force, who was originally twelfth seeded, earned second place after losing six to none.</p>

<p>Overall, the event continues to open doors for young teams like Fly Society who placed ninth, but managed to make a name for themselves. Congratulations to all of the winners and shout out to everyone who helped make this possible. The next event is in July at Anaheim, CA; can you afford to miss greatness in the making? http:www.majorleaguegaming.com</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jun 6</div></div><div class="blog-content"><h2><a href="/blog/2011/06/06/cucumber-and-behavior-driven-infrastructure-validation/">Cucumber and Behavior Driven Infrastructure Validation</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>Did you ever think to use Cucumber to write scenarios to validate your infrastructure? Here's a short guide to help you get started.</p>

<p>I'm going to keep this intentionally short because I don't want to steal the thunder away from our systems team, but I did get a fair number of pings inquiring about this after tweeting about it, so it's worth getting the word out.</p>

<p><strong>Start a new infrastructure validation project</strong></p>

<p>Your Gemfile should reference the gems for rake and cucumber at a minimum. The Rakefile can be the minimal Cucumber-ified to get started.</p>

<p>{% gist 1011361 %}</p>

<p><strong>Write your Cucumber features and scenarios for the parts of the infrastructure you want to validate</strong></p>

<p>Examples of this may be "aliveness" of servers by pinging them or making sure processes are running. For example, with MySQL:</p>

<p>{% gist 1011369 %}</p>

<p>You'll need to back those scenario step definitions up with the appropriate code. I'm going to leave that out of this post for now.</p>

<p><strong>Tag your scenarios appropriately</strong></p>

<p>You should tag your scenarios in the manner that makes sense for your organization and in the way that you'll be running them and responding to them. For example, you may want to run @critical scenarios from cron every 5 minutes (or some appropriate interval) and make sure that if these fail, someone gets more than an e-mail. You may want to run @rise_and_shine scenarios at 6 AM after other system tasks have run, for example, to validate log rotation.</p>

<p><strong>KISS me baby</strong></p>

<p>Keep It Simple Stupid. If you just want to use this for sanity checks, that's cool. You might not need to go full scale <a href="http://www.nagios.org/">Nagios</a> and <a href="http://auxesis.github.com/cucumber-nagios/">cucumber-nagios</a> right away. Integrate this into your existing infrastructure and monitoring processes in the way that it makes the most sense.</p>

<p>Hopefully this has been helpful to you. I'll keep pushing the systems team here to get the bloggity blog blog posts about this coming. If you want to follow those guys, be sure to follow <a href="http://twitter.com/ironwallaby">@ironwallaby</a>, <a href="http://twitter.com/dahui0401">@dahui0401</a> and <a href="http://twitter.com/gwaldo">@gwaldo</a>.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">@CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">May 27</div></div><div class="blog-content"><h2><a href="/blog/2011/05/27/testing-multiple-ruby-versions-and-gemsets-using-rvm/">Testing Multiple Ruby Versions and Gemsets Using RVM</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>I think it might be all the time I'm devoting to L.A. Noire which caused me to want to research how to test multiple Ruby versions and gemsets using RVM, but that's besides the point. Here's how I went about it.</p>

<p>I've been testing this with 2 gems I maintain, <a href="https://github.com/czarneckid/tasty">tasty</a> - a Ruby gem for interacting with the del.icio.us service and <a href="https://github.com/agoragames/leaderboard">leaderboard</a> - Leaderboards backed by Redis in Ruby. I'll use tasty as the example for this blog post.</p>

<p>The .rvmrc file for the tasty gem looks like:</p>

<p>{% gist 996225 %}</p>

<p>In the Rakefile for the tasty gem I have the following:</p>

<p>{% gist 996230 %}</p>

<p>If I run rake, I get the following output, correctly showing that rake uses the tasty_gem gemset for each version of Ruby.</p>

<p>{% gist 996224 %}</p>

<p>I also used "_gem" in the gemset names. Is that overkill? I was just trying to not conflict with say a project you might have called "tasty" with it's own tasty gemset.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">May 19</div></div><div class="blog-content"><h2><a href="/blog/2011/05/19/the-haigha-preview/">The Haigha Preview</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>Agora has released a preview of Haigha, its new Python client for Advanced Message Queuing Protocol (AMQP). AMQP is a standardized application protocol for messaging middleware. Its purpose is to govern the behavior of the messaging provider and receiver to facilitate interoperability between vendors.</p>

<p>Haigha is a descendant of py-amqplib, a common library used by the Python community. Haigha has been built from the ground up to use libevent for high performance IO while presenting a simple API that adheres to the form and function of the AMQP specification. It adds several useful features that simplify access to powerful AMQP idioms. By default, Haigha operates in a completely asynchronous mode, using callback-passing to trigger application code in response to AMQP events.</p>

<p>For more information and installation, visit: <a href="https://github.com/agoragames/haigha"> https://github.com/agoragames/haigha</a></p>

<p> </p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">May 19</div></div><div class="blog-content"><h2><a href="/blog/2011/05/19/tech-valley-talks/">Tech Valley Talks </a></h2><div class="blog-author">By <strong>Clarke Foley</strong></div><div class="blog-body"><p>Members of the Agora Production and QA team attended the first Kitware-sponsored Tech Valley Talks on Tuesday. Clarke Foley, Production Coordinator, and Devon Smith, QA Team Lead, represented Agora amongst a who's-who of Tech Valley companies. Nicholas Ruepp, Producer at Vicarious Visions (VV), spoke about how the successful game studio adapted to the Agile Development process during the production of Marvel Ultimate Alliance 2 in 2007.</p>

<p>At this time, VV implemented 3-week sprints, burndown charts, and retrospectives, along with cork boards as a project-tracking tool. The "Big Wins" that were realized with the Scrum/Agile processes included seeing a steady level of effort from developers throughout a project life cycle, rather than the typical waterfall process and it's subsequent employee burnout.  Also, the new iterative planning allowed day-to-day developer overhead to be very low, and the entire company shifted its culture to a more cross-discipline mentality.</p>

<p>Bill Hoffman, VP and CTO of Kitware Inc. began his presentation with a very poignant fact; “the use of Agile is intended to remove waste from the development system”. There are seven common inefficiencies that many game and software development companies face. These include partially done work, extra features, relearning, hand-offs, task switching, delays, and defects. Through Kitware's adaptation of the Agile process, they have been able to reduce inefficiencies in their workflow. Hoffman's token Agile ideology is the differing of feature commitment as long as possible. Doing this allows for flexibility while keeping options open as long as possible. According to Hoffman, having high-speed production must be enabled by inherent quality standards; the job of testing is to prevent defects not to find them.</p>

<p>Hoffman mentioned that Kitware uses Mantis Issue Tracker, Visual Tool Kit, and Python scripts to create burndown charts. While the tools don't always make the mechanic, it is interesting to see which is preferred. At Agora, Pivotal Tracker and Lighthouse are the primary Agile Project Management tool and bug trackers. New testing tools for support of iterative software development include Cucumber, Rspec, and Litmus along with Siege for load testing. Overall, we look forward to the next Tech Valley event. We hope to hearing about other Capital Region technology firms and how they are increasing their production and profitability with the Agile Development process.</p>

<p> </p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Apr 29</div></div><div class="blog-content"><h2><a href="/blog/2011/04/29/speed-up-testing-with-spork/">Speed Up Testing With Spork</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>If you TATFT, embrace red-green-refactor, or you just want to speed up execution of your test suite, you might want to take a look at <a href="https://github.com/timcharper/spork">Spork</a>. It will fork a test server for you that pre-loads your environment allowing you to run individual tests or your entire test suite without the startup cost of the loading the environment for each test or test suite run.</p>

<p>Here's a quick setup guide for testunit with <a href="https://github.com/timcharper/spork-testunit">spork-testunit</a>, but if you're using RSpec, then it should "just work".</p>

<ol>
  <li>Add the following to your project's Gemfile.</li>
</ol>

<p><code>ruby
 group :test, :development do
   gem 'spork'
   gem 'spork-testunit'
 end
</code></p>

<ol>
  <li>
    <p>Run "bundle install" to install the gems.</p>
  </li>
  <li>
    <p>Run "spork testunit –bootstrap" to bootstrap your test/test_helper.rb file.</p>
  </li>
  <li>
    <p>Move your current test_helper "stuff" into the Spork.prefork block.</p>
  </li>
  <li>
    <p>Start spork in a terminal in your project directory.</p>
  </li>
  <li>
    <p>Run your full test suite in a another terminal in your project directory, "testdrb -Itest **/*.rb". It should run without any environment startup "cost". You can run individual tests, just the unit tests, just the functional tests, etc. in a similar fashion.</p>
  </li>
</ol>

<p>It seems like the 0.9.0.rc5 version of Spork is the one that handles underlying code changes correctly so you don't have to restart spork each time you change controller or model code.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Apr 19</div></div><div class="blog-content"><h2><a href="/blog/2011/04/19/capistrano-and-campfire-after-deploy-hook-for-the-lulz/">Capistrano and Campfire After-Deploy Hook For The Lulz</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>We recently started using <a href="https://github.com/technicalpickles/capistrano-mountaintop">capistrano-mountaintop</a> to announce when deploys to our environments are taking place. This morning, <a href="https://twitter.com/andkjar">@andkjar</a> noted that it'd be nice to see if the deploy was successful or not since it pastes the deploy log and it's long enough that you might not see whether or not the deploy was successful. This simple addition to deploy.rb checks the deploy log for success or failure and pastes an appropriate image into our Campfire room.</p>

<p>{% gist 929219 %}</p>

<p>Success results in:</p>

<p><img alt="" title="Deploy Successful" alt="" width="300" height="292" src="/assets/images/uploads/2011/04/Screen-shot-2011-04-19-at-2.44.39-PM-300x292-1a2390d6.png" /></p>

<p>Failure results in:</p>

<p><img alt="" title="Deploy Failure" alt="" width="300" height="292" src="/assets/images/uploads/2011/04/Screen-shot-2011-04-19-at-2.44.51-PM-300x292-974474b8.png" /></p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Apr 3</div></div><div class="blog-content"><h2><a href="/blog/2011/04/03/reduce-your-open-source-technical-debt-using-these-easy-steps/">Reduce Your Open Source Technical Debt Using These Easy Steps!</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>Do you know what all those GitHub projects you've got forked to your personal GitHub account are? <a href="http://en.wikipedia.org/wiki/Technical_debt">Technical debt</a>. Follow these easy steps to enjoy a debt-free open source lifestyle.</p>

<ol>
  <li>Watch a project, don't fork it.</li>
</ol>

<p>Your GitHub news feed is your friend and you're already using a news aggregator right? Watching a project will ensure you're kept up-to-date on project happenings (commits, issues, pull requests, etc.) without having to fork the code.</p>

<ol>
  <li>If you fork a project, contribute something back to the project.</li>
</ol>

<p>I did this awhile back with a project called soulmate. It got mention on Hacker News, I checked it out, saw there were no tests, over 300 watchers, and felt charitable. I forked the project and <a href="https://github.com/seatgeek/soulmate/commit/a596eb5b45738bfad5ec8228c8c2c53220aec12d">contributed my updates to show an integration test and start and stop Redis automatically when running the tests</a>.</p>

<p>Once the project integrated my changes, I deleted my fork. Why? I was never going to do anything with soulmate, so why keep the fork around? If the project owner comes back to you and requests changes to your pull request, make them and move on. Delete your fork unless you're going to contribute more to the project. If you are going to contribute more to the project, follow step #3 below.</p>

<ol>
  <li>If you fork a project, configure a remote branch to track upstream project changes.</li>
</ol>

<p>When you fork a project on GitHub, a remote branch for tracking is not automatically created for you. By doing this, you can stay in-sync with the main project's codebase.</p>

<p>{% gist 900703 %}</p>

<p>I am proud to say that I am living a debt free lifestyle on my <a href="https://github.com/czarneckid">GitHub account</a>. The 3 forked projects I have up there now, all have open pull requests to their respective project's main codebase. Once those pull requests are accepted or rejected, I will delete my forks unless I am going to contribute more to the project.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Mar 7</div></div><div class="blog-content"><h2><a href="/blog/2011/03/07/ensuring-balanced-reads-with-pymongo/">Ensuring balanced reads with PyMongo</a></h2><div class="blog-author">By <strong>Aaron Westendorf</strong></div><div class="blog-body"><p>Over the past year we've been evaluating and migrating many of our game services over to <a href="http://www.mongodb.org/">mongoDB</a>. Its feature set gives us complete freedom to iterate with developers during game production, its performance is sufficient to power our infrastructure during peak load, our operations team appreciate its powerful administration tools, and 10gen has so far proven itself a reliable technology partner and steward of the Mongo roadmap. One of the very important features of PyMongo that we have made use of is the MasterSlaveConnection, but it's not without its caveats, one of those being that it does not guarantee you are balancing your reads across a replica set.</p>

<p>Before we dig in, a few items of note. First, the situation I'm covering here is specifically when you're connecting directly to a <a href="http://www.mongodb.org/display/DOCS/Replica+Sets">replica set</a>. There may be a similar pattern to follow on a sharded database, but that's outside the scope of this post and what our team is working with. Secondly, if you're not familiar with the <a href="http://api.mongodb.org/python/1.9%2B/api/pymongo/master_slave_connection.html">MasterSlaveConnection</a>, the gist of the class is that it directs all writes to the current master, and randomly choses a slave for each read-only query. Lastly, we have some pending <a href="https://github.com/mongodb/mongo-python-driver/pull/24">patches</a> to pymongo 1.9 that I recommend applying before you begin, as they'll affect your ability to use the MasterSlaveConnection and seamlessly restart or shutdown hosts in your replica set.</p>

<p>The situation we're correcting for here is where we have a replica set, with one or more slaves, and we want to maintain balanced reads across them. Our application is long running, and at any time the operations team may remove a host from the replica set to perform maintenance. Mongo and pymongo will work together to ensure high availability failover, but once you've brought your replica set back to full capacity, your application will not connect to that host unless there's another socket disconnect, and even then not guarantee it will connect to the original host. You've now lost a substantial amount of performance and scalability until your application has restarted.</p>

<p>{% gist 858617 %}</p>

<p>Read through connection() to understand the basics of instantiating a MasterSlaveConnection, or in this case our subclass ClusterConnection. It is initialized with a single Connection to the master, and then for each host in our list, we create a slave Connection. The Connection class is smart in that it can maintain a list of hosts, both configured and discovered from the replica set, and connect to any one of them at any time. The master Connection will always connect to the current master out of our list of hosts and handle when the master changes. The slave connections are configured with slave_okay=True so that they'll stay connected to whichever host we tell them and failover to other slaves, and _connect=False is passed so that if a slave is not currently available, Connection and MasterSlaveConnection can kindly follow their AutoReconnect paths without interrupting your application. So long as you have just the master up, you'll never know that the replica set may be impaired at the time you initialize the connection.</p>

<p>The class ApplicationDatabaseInterface is simply an example of whatever you use to maintain an interface to the database within your application. The only requirement here is that we have some ability to cache an existing MasterSlaveConnection and call validate_slaves() on it before we use it. I recommend validating the slaves only once per application "transaction", however that may apply to your use case (see query() in the example above).</p>

<p>The validate_slaves() method is really where the important work is done. This example implementation will check for us every 5 minutes, but your criteria and interval can be whatever suites your needs. First it uses the same code as pymongo to parse the slave URIs so you can support host and port schemes. It walks through all of the slaves and if the current host and port of a Connection are not in the list of configured hosts, closes that connection and removes it from the slave list. If there are any hosts in our list of slaves which do not have a connection, it then re-populates the slave list with a fresh Connection for that host. The new connection also includes the _connect=False flag, so we'll never get an AutoReconnect exception in case a slave is not available at the time this code is run.</p>

<p>The reason we remove connections from the slave list is because the Connection class doesn't maintain its internal list of possible hosts in any <a href="http://jira.mongodb.org/browse/PYTHON-218">priority</a>. If we simply closed the connection it will reconnect, but we aren't guaranteed that it will reconnect to its originally-configured host, and that's what we're trying to ensure.</p>

<p>The last important bit of this is the with_reconnect decorator. It's not strictly required, but for completeness, you should have something like this in your stack when communicating with Mongo. In addition to connection drops, there are situations such as <a href="http://jira.mongodb.org/browse/PYTHON-216">this</a> where the driver will raise an AutoReconnect because the replica set is in transition. I've found that 2 seconds is about the maximum amount of time it takes for pymongo and the replica set to agree that all is well with the world, so this example decorator gives enough time for that situation to resolve itself.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Mar 2</div></div><div class="blog-content"><h2><a href="/blog/2011/03/02/chai-the-simple-python-mock/">Chai, the simple Python mock</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>Here at Agora we take testing seriously, insisting that full test coverage always be part of a deliverable and adjusting our schedules accordingly. We are historically a <a href="http://blog.agoragames.com/category/engineering/ruby-engineering/">Rails</a> shop, but for a few years we have been developing an <a href="http://blog.agoragames.com/2010/06/28/lifting-the-tail-inside-agora-skunk-works/">extensive</a> Python code base and infrastructure to power our in-game offerings.</p>

<p>We've been using <a href="http://code.google.com/p/pymox/">Mox</a> as our mock testing solution since 2009, and though it has met all of our functional requirements, we've longed for the simplicity and power of Ruby's <a href="http://mocha.rubyforge.org/">Mocha</a> framework. This past Friday we held our 3rd Hack-A-Thon, and <a href="https://github.com/vbabiy">Vitaly Babiy</a> and <a href="https://github.com/awestendorf">I</a> developed <a href="https://github.com/agoragames/chai/">Chai</a>, a mocking framework patterned after Mocha.</p>

<p>{% gist 848107 %}</p>

<p>You can find the latest source and documentation at <a href="https://github.com/agoragames/chai/">GitHub</a>, or install from <a href="http://pypi.python.org/pypi/chai">pypi</a>. The current release is 0.1.0 and we're looking for <a href="https://github.com/agoragames/chai/issues">feedback</a>. We're adding lots of features and improving the API, so <a href="https://github.com/agoragames/chai/">check back</a> frequently.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Feb 25</div></div><div class="blog-content"><h2><a href="/blog/2011/02/25/meta-leaderboards/">Meta Leaderboards</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>Traditionally, leaderboards rank players using one criteria, e.g. XP, kills, etc. What if you wanted to retrieve information from a leaderboard that combined more than one criteria? I'm going to show you how to do that.</p>

<p>To be honest, I don't necessarily have a definite use case for this functionality, but I thought it might be useful. So, here goes nothing.</p>

<p>Let's say you've got a game and its multiplayer mode can be played across 5 maps. We'll also simplify things and say that we're only ranking players on each map on XP gained when finishing the map. If you want to generate a leaderboard of players ranked by XP who have played in any of the maps, you would need to perform a merge of each of the leaderboards for the 5 maps. If you want to generate a leaderboard of players ranked by XP who have played in each of the maps, you would need to perform an intersection of each of the leaderboards for the 5 maps.</p>

<p>This functionality is now present in the <a href="https://github.com/agoragames/leaderboard">Ruby leaderboard gem</a> released today.</p>

<p>You can use the merge_leaderboards(…) call to merge the current leaderboard with any other leaderboards into a new leaderboard.</p>

<p>{% gist 843517 %}</p>

<p>You can use the intersect_leaderboards(…) call to intersect the current leaderboard with any other leaderboards into a new leaderboard.</p>

<p>{% gist 843527 %}</p>

<p>Hopefully you'll find this functionality useful.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Feb 24</div></div><div class="blog-content"><h2><a href="/blog/2011/02/24/your-definition-of-success/">Your Definition of Success</a></h2><div class="blog-author">By <strong>Mike DelPrete</strong></div><div class="blog-body"><p>I have been called many things in my life. Most recently, some have called me a “successful entrepreneur.” I am introduced to people as the CEO of a “successful business,” or prompted to tell classes of my “success story.” But what is success?</p>

<p>Success can mean many things to different people. I like to use the phrase “depending on your definition of success” when talking to people looking to start a business, because that definition changes everything.</p>

<p>For some it might be to create a billion dollar company. For others it may mean working happily with a handful or coworkers. Success is a multi-dimensional factor, and can be based on financial, personal, product, or legacy criteria (among others).</p>

<p>If you want to start a business, first figure out your measure of success. What are you trying to accomplish? Is it all about the people, the product, or just making money? What motivates you and what goal are you striving towards?</p>

<p>At Agora, I’ve defined success as many things. It’s doing high quality work that I’m proud of. It’s creating and maintaining a reputation as an awesome company to work for. It’s being profitable, so I can keep doing what I love.</p>

<p>To me, success is not about being a certain size, reaching certain revenue numbers, or doing a certain number of sales in a year. These are all a means to an end. For me – for Agora – success is having a job like no other; if I manage to create an incredible place to work, staffed with incredible people, doing incredible work, I am successful.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Feb 17</div></div><div class="blog-content"><h2><a href="/blog/2011/02/17/the-path-of-iteration-in-business/">The Path of Iteration in Business</a></h2><div class="blog-author">By <strong>Mike DelPrete</strong></div><div class="blog-body"><p>Entrepreneurs often ask me what the biggest factor was in our success. They want to know exactly what we did and how we did it so that they can duplicate that success. The truth is that there isn’t one thing, and there never is. You can never attribute the success of a multi-year, multi-person venture down to exactly one thing. However, there <em>are</em> factors that can help.</p>

<p>The advice I give to entrepreneurs is simple: just keep trying. Succeeding with a business is a result of hard work and constantly trying new things. Don’t put all of your eggs in one basket and hope it works out. Try something, get it out there, and repeat.</p>

<p>Many entrepreneurs are stuck on the notion of a “master plan.” They think of a huge idea with huge potential returns, huge risk, and a huge cost. In reality, no one can perfectly plan where the business will take you.</p>

<p>Instead of executing on a plan with a high risk and high reward, I encourage entrepreneurs to take baby steps. Interested in a particular market? What’s the quickest, simplest project you could do to take you there? Have a product idea? What’s the easiest and quickest way to develop a prototype? How can you get something out in a month instead of a year?</p>

<p>While not the single key to our success, adaptability has been a huge part of it. Take an idea, try it out, and learn from it. Instead of plotting out a 12-month plan to launch your business, focus instead of taking smaller steps in the general direction you want to go. The knowledge you gain along the path of iteration is well worth it.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Feb 11</div></div><div class="blog-content"><h2><a href="/blog/2011/02/11/code-reviews/">Code Reviews</a></h2><div class="blog-author">By <strong>Brian Corrigan</strong></div><div class="blog-body"><p>Everyone knows code reviews can be awesome. They can be agile, smart and effective, or they can be shallow and pedantic. They can be an hour-long laser-focused meeting on the points that matter, or a rambling mess of code reading to sleepy co-workers desperate for some cookies and a nap. I'm on the team that builds backend services for the latest and greatest games; we take code reviews very seriously, and we look forward to them. So how do we go about it?</p>

<p>We've developed two schemes for official code reviews, and each one serves a unique purpose. The first approach grew organically and is informal, whereas the second is a relatively new scheme that we've adopted and has already been very successful.</p>

<p>Our older code reviews are somewhat similar to how many other teams conduct their reviews. A major new piece of code is written, and if on general consensus it is deemed "important", each person on our team, or at least 2-3 of us, are responsible for giving it a thorough review, writing down their notes and attaching them to a <a href="http://lighthouseapp.com/">Lighthouse</a> ticket. We schedule a time for review, and then gather as a group and walk through each and every item of note, discussing as necessary. Usually the original developer leads the review, though one of the reviewers may also lead the discussion. We typically use this style of code review for new modules and services which are deployed in development or staging, to be entering production "in the future". It is the first pass review, intended to bring many eyes to bear on immature code, where only one or two people may have been involved in implementation.</p>

<p>We've adopted a more formal practice for services and modules entering production. For any given title which is nearing production, we list all of the services it is using, including ones that may be very mature. For each service, we assign two reviewers and one change implementor, preferably none of the people who originally wrote the module, though in a small agile team this can be open to interpretation or convenience. The reviewers each perform a rigorous analysis, covering everything from code to configuration, interaction with other modules and services, algorithm efficiency, test suite coverage and whether the entire package conforms to the latest team practices. Our standards continue to evolve, and so even mature services benefit from this continual review process. A third person, the change implementor, then applies the recommended changes as well as anything else they see as needing improvement. The reviewers then review the changes, recommend additional fixes, pass back to the change implementor, and so on, until all 3 individuals agree that the service is ready for production. We make liberal use of <a href="http://git-scm.com/">git</a> branches to track these changes. Near launch day, a fourth team member is responsible for confirming that the production deploy is operational; configurations comply with the final requirements, databases and other datastores are setup as designed, and <a href="http://www.rabbitmq.com/">AMQP</a> hosts are operating as expected.</p>

<p>In addition to these two formal schemes, we also use git and <a href="http://campfirenow.com/">Campfire</a> to continually review smaller changes. Each team member discusses their recent work in our daily standups and brings attention to code they think needs attention from others, and everyone takes part in reviewing changelists and recommending improvements as their schedules allow.</p>

<p>We've realized great benefit of these two approaches in combination. The former yields an informal but wide review of the code base, giving everyone an opportunity to understand the bleeding edge of our technology. Sometimes this includes learning an entirely new language or framework during the course of the review. The latter style yields a production-ready deliverable that has been approved by no fewer than 4 members of our team. In practice, the entire team has had a chance to either code a feature, review it, or implement changes, such that everyone can sign off that we are ready stand behind the coming tsunami of happy gamers playing the best new titles on the market. Both schemes allow individuals to thoroughly review the code at their own pace and according to their own schedules, so that group time is dedicated solely to discussing the items of importance. Everyone is involved in the success, proudly putting their signature on the final product even when their role in supporting a particular title may have been minor.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jan 14</div></div><div class="blog-content"><h2><a href="/blog/2011/01/14/brightcoveapi-newhome-brightcoveos/">Brightcove::API.new(:home => BrightcoveOS)</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>I am pleased to announce the <a href="https://github.com/BrightcoveOS/Ruby-MAPI-Wrapper">brightcove-api gem</a> that I maintain has a new home at the <a href="http://opensource.brightcove.com/">Brightcove Open Source portal</a>.</p>

<p>In June 2010, I wrote the brightcove-api gem to interact with the <a href="http://www.brightcove.com/en/">Brightcove</a> media APIs. We've used it to build sites like <a href="http://tv.majorleaguegaming.com/">MLG.tv</a>. Last night I attended the NY Brightcove User's Group meeting and found out about their <a href="http://opensource.brightcove.com/">Brightcove Open Source portal</a>. So, I wrote to the good folks behind the Open Source @ Brightcove effort to get the brightcove-api gem added to their third party projects. They offered me door #2 and a chance to make it the officially "official" library for interacting with the Brightcove Media API from Ruby.</p>

<p>And so here we are, the brightcove-api gem now lives alongside the other open source libraries for interacting with Brightcove. I'll still be the maintainer of the library and since it's open source, you can and always will be able to contribute to its continued development.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jan 11</div></div><div class="blog-content"><h2><a href="/blog/2011/01/11/thumbs-up/">Thumbs Up</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>In the process of investigating the potential use of the <a href="https://github.com/brady8/thumbs_up">thumbs_up gem</a> (enable voting in your Rails 3 application) on a project today, I came across 2 opportunities to contribute back to the project.</p>

<p>Those opportunities are now realities in that: I forked the project on GitHub, made my changes, and <a href="https://github.com/brady8/thumbs_up/pull/7">generated a pull request</a> for those changes to be integrated back into the thumbs_up project. So, what did I change?</p>

<ul>
  <li>
    <p>My first commit was a simple change to the documentation clarifying the use of one method. No brainer right?</p>
  </li>
  <li>
    <p>My second commit was a bit more involved and wasn't necessarily a change I thought had to be there, but might be nice to be included. It involved getting into some of the internals in how the database migration and model file are generated. If this commit isn't integrated, I won't lose any sleep over it. It was a great opportunity to learn about some of the internals of <a href="http://edgeguides.rubyonrails.org/generators.html">Rails 3 generators</a> and <a href="https://github.com/wycats/thor">Thor</a>. I'm not going to lie in that before all was said and done, I wanted to shoot myself into the sun on a rocketship, but I'm over it now.</p>
  </li>
</ul>

<p>Why am I writing this blog post? It just gives me a warm and fuzzy feeling (apart from the scotch), to know that I can contribute my day-to-day work back to the development community for others to benefit. So, thumbs up to that right?</p>

<p><strong>UPDATE:</strong> My changes (that now encompass the start of a test suite, have now been integrated into the thumbs_up gem. So d ' _ ' b to open source!</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jan 5</div></div><div class="blog-content"><h2><a href="/blog/2011/01/05/follow-the-leader/">Follow The Leader - Leaderboards with Ruby/Redis</a></h2><div class="blog-author">By <strong>David Czarnecki1</strong></div><div class="blog-body"><p>Leaderboard: A board showing the ranking of leaders in a competition.</p>

<p>Do you need to create leaderboards for your application? Do you use <a href="http://redis.io/">Redis</a>? Do you use <a href="http://www.ruby-lang.org/en/">Ruby</a>? If you've answered yes to any or all of these questions, you might want to take a look at the <a href="https://github.com/agoragames/leaderboard">leaderboard gem</a> I am releasing today.</p>

<p>At Agora Games, one of the things we think a lot about is leaderboards. As they're a small, but important part of the work we do, I’m looking for ways to improve leaderboard generation for various situations. This effort was really the logical next step to my blog post, <a href="http://blog.agoragames.com/2011/01/01/creating-high-score-tables-leaderboards-using-redis/">Creating high score tables (leaderboards) using Redis</a>. All of the information you'd probably be interested in as a developer in terms of working with the gem can be found on the <a href="https://github.com/agoragames/leaderboard">leaderboard gem</a> page. Here's a quick rundown of some of the gem's capabilities:</p>

<ul>
  <li>
    <p>Attach to a new or existing leaderboard</p>
  </li>
  <li>
    <p>Add and remove members from a leaderboard</p>
  </li>
  <li>
    <p>Return information about a leaderboard such as total members, total pages</p>
  </li>
  <li>
    <p>Return information about a member in the leaderboard such as their rank or score</p>
  </li>
  <li>
    <p>Update score information about a member in the leaderboard</p>
  </li>
  <li>
    <p>Retrieve the leaders from a leaderboard with ability to page within the leaderboard</p>
  </li>
  <li>
    <p>Retrieve the leaders around a given member in a leaderboard, also known as an "Around Me" leaderboard</p>
  </li>
  <li>
    <p>Retrieve information for an arbitrary list of members in a leaderboard, e.g. How do my friends compare against me?</p>
  </li>
</ul>

<p>I believe that this covers most of the interaction you might have with a leaderboard. But, if not, this code is open source, so feel free to contribute to its development.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jan 2</div></div><div class="blog-content"><h2><a href="/blog/2011/01/02/creating-high-score-tables-leaderboards-using-redis-2/">Creating high score tables (leaderboards) using Redis</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>To my other colleagues at Agora Games, I have one word: FIRST!</p>

<table>
  <tbody>
    <tr>
      <td>Now that I've got that out of my system, down to the business at hand. I've read a number of articles on <a href="http://redis.io/">Redis</a> that mention how it could be used for high score tables (leaderboards), but I didn't see any examples that would walk you through exactly how to do that. Time to rectify that since it's 2011 and we still don't have flying cars … so ,,</td>
      <td>, future.</td>
    </tr>
  </tbody>
</table>

<p><strong>UPDATE: Please use the <a href="../2011/01/01/creating-high-score-tables-leaderboards-using-redis/">original post for any comments/feedback</a>. This post is a placeholder.</strong></p>

<p><strong>UPDATE:</strong> All of this has been packaged up in the <a href="https://github.com/agoragames/leaderboard">leaderboard gem on GitHub</a>.</p>

<p>Leaderboards are a small, but important part of the engineering we do at Agora Games. As such, <a href="http://twitter.com/CzarneckiD/status/21081627241226241">when not riding the short bus</a>, I'm looking for ways to improve leaderboard generation for various situations. So, here's how I might approach creating leaderboards using Redis.</p>

<p>I offer the following gist. Here's the jist of the gist:</p>

<ul>
  <li>
    <p>The following was prototyped using the redis CLI. You can obviously port the logic to your favorite language binding for Redis, *cough* Ruby *cough*.</p>
  </li>
  <li>
    <p>You will be using the <a href="http://redis.io/commands#sorted_set">Sorted Set</a> commands in Redis.</p>
  </li>
  <li>
    <p>You will need to be running at least Redis 2.1.6 to use the ZREVRANGEBYSCORE method.</p>
  </li>
  <li>
    <p>Add players to the HIGHSCORES "table" using the ZADD method.</p>
  </li>
  <li>
    <p>Print out the players (with a given page size) from the HIGHSCORES "table" using the ZREVRANGEBYSCORE method to show scores from highest to lowest.</p>
  </li>
  <li>
    <p>There is some bookkeeping code that you would do at the application level in terms of tracking what page you are on, dividing the total # of leaderboard entries into pages for a given page size, etc.</p>
  </li>
  <li>
    <p>Create an "Around Me" leaderboard with scores of individuals above and below an individual player using a combination of the ZREVRANK and ZREVRANGEBYSCORE methods.</p>
  </li>
  <li>
    <p>Again, there is some bookkeeping code that you would do at the application level in terms of tracking how many players above or below to show and taking into account offsets.</p>
  </li>
  <li>
    <p>The data that you store for a given player could be richer than just the player name or player ID. This is probably a larger design consideration if you are considering the "Around Me" leaderboard situation.</p>
  </li>
</ul>

<p>{% gist 762065 %}</p>

<p><strong>UPDATE: 1/3/2011:</strong> I updated the gist to do the "Around Me" leaderboard in 2 calls.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div><div class="blog-entry"><div class="date-comments"><div class="date">Jan 1</div></div><div class="blog-content"><h2><a href="/blog/2011/01/01/creating-high-score-tables-leaderboards-using-redis/">Creating high score tables (leaderboards) using Redis</a></h2><div class="blog-author">By <strong>David Czarnecki</strong></div><div class="blog-body"><p>To my other colleagues at Agora Games, I have one word: FIRST!</p>

<table>
  <tbody>
    <tr>
      <td>Now that I've got that out of my system, down to the business at hand. I've read a number of articles on <a href="http://redis.io">Redis</a> that mention how it could be used for high score tables (leaderboards), but I didn't see any examples that would walk you through exactly how to do that. Time to rectify that since it's 2011 and we still don't have flying cars … so ,,</td>
      <td>, future.</td>
    </tr>
  </tbody>
</table>

<p><strong>UPDATE:</strong> All of this has been packaged up in the <a href="https://github.com/agoragames/leaderboard">leaderboard gem on GitHub</a>.</p>

<p>Leaderboards are a small, but important part of the engineering we do at Agora Games. As such, <a href="http://twitter.com/CzarneckiD/status/21081627241226241">when not riding the short bus</a>, I'm looking for ways to improve leaderboard generation for various situations. So, here's how I might approach creating leaderboards using Redis.</p>

<p>I offer the following gist. Here's the jist of the gist:</p>

<ul>
  <li>
    <p>The following was prototyped using the redis CLI. You can obviously port the logic to your favorite language binding for Redis, *cough* Ruby *cough*.</p>
  </li>
  <li>
    <p>You will be using the <a href="http://redis.io/commands#sorted_set">Sorted Set</a> commands in Redis.</p>
  </li>
  <li>
    <p>You will need to be running at least Redis 2.1.6 to use the ZREVRANGEBYSCORE method.</p>
  </li>
  <li>
    <p>Add players to the HIGHSCORES "table" using the ZADD method.</p>
  </li>
  <li>
    <p>Print out the players (with a given page size) from the HIGHSCORES "table" using the ZREVRANGEBYSCORE method to show scores from highest to lowest.</p>
  </li>
  <li>
    <p>There is some bookkeeping code that you would do at the application level in terms of tracking what page you are on, dividing the total # of leaderboard entries into pages for a given page size, etc.</p>
  </li>
  <li>
    <p>Create an "Around Me" leaderboard with scores of individuals above and below an individual player using a combination of the ZREVRANK and ZREVRANGEBYSCORE methods.</p>
  </li>
  <li>
    <p>Again, there is some bookkeeping code that you would do at the application level in terms of tracking how many players above or below to show and taking into account offsets.</p>
  </li>
  <li>
    <p>The data that you store for a given player could be richer than just the player name or player ID. This is probably a larger design consideration if you are considering the "Around Me" leaderboard situation.</p>
  </li>
</ul>

<p>{% gist 762065 %}</p>

<p><strong>UPDATE: 1/3/2011:</strong> I updated the gist to do the "Around Me" leaderboard in 2 calls.</p>

<p>You can find more hilarity over on my Twitter account, <a href="http://twitter.com/czarneckid">CzarneckiD</a>.</p>
</div></div></div></section><aside id="sidebar"><div class="block" id="block-archive"><h2>Blog archives</h2><h3>2014</h3><ul><li><a href="/blog/2014/03/">March 2014</a></li><li><a href="/blog/2014/02/">February 2014</a></li><li><a href="/blog/2014/01/">January 2014</a></li></ul><h3>2013</h3><ul><li><a href="/blog/2013/11/">November 2013</a></li><li><a href="/blog/2013/10/">October 2013</a></li><li><a href="/blog/2013/09/">September 2013</a></li><li><a href="/blog/2013/08/">August 2013</a></li><li><a href="/blog/2013/07/">July 2013</a></li><li><a href="/blog/2013/06/">June 2013</a></li><li><a href="/blog/2013/05/">May 2013</a></li><li><a href="/blog/2013/04/">April 2013</a></li><li><a href="/blog/2013/03/">March 2013</a></li><li><a href="/blog/2013/02/">February 2013</a></li><li><a href="/blog/2013/01/">January 2013</a></li></ul><h3>2012</h3><ul><li><a href="/blog/2012/12/">December 2012</a></li><li><a href="/blog/2012/11/">November 2012</a></li><li><a href="/blog/2012/10/">October 2012</a></li><li><a href="/blog/2012/09/">September 2012</a></li><li><a href="/blog/2012/08/">August 2012</a></li><li><a href="/blog/2012/07/">July 2012</a></li><li><a href="/blog/2012/06/">June 2012</a></li><li><a href="/blog/2012/05/">May 2012</a></li><li><a href="/blog/2012/04/">April 2012</a></li><li><a href="/blog/2012/03/">March 2012</a></li><li><a href="/blog/2012/02/">February 2012</a></li><li><a href="/blog/2012/01/">January 2012</a></li></ul><h3>2011</h3><ul><li><a href="/blog/2011/10/">October 2011</a></li><li><a href="/blog/2011/09/">September 2011</a></li><li><a href="/blog/2011/08/">August 2011</a></li><li><a href="/blog/2011/07/">July 2011</a></li><li><a href="/blog/2011/06/">June 2011</a></li><li><a href="/blog/2011/05/">May 2011</a></li><li><a href="/blog/2011/04/">April 2011</a></li><li><a href="/blog/2011/03/">March 2011</a></li><li><a href="/blog/2011/02/">February 2011</a></li><li><a href="/blog/2011/01/">January 2011</a></li></ul><h3>2010</h3><ul><li><a href="/blog/2010/12/">December 2010</a></li><li><a href="/blog/2010/11/">November 2010</a></li><li><a href="/blog/2010/10/">October 2010</a></li><li><a href="/blog/2010/09/">September 2010</a></li><li><a href="/blog/2010/08/">August 2010</a></li><li><a href="/blog/2010/07/">July 2010</a></li><li><a href="/blog/2010/06/">June 2010</a></li><li><a href="/blog/2010/05/">May 2010</a></li><li><a href="/blog/2010/04/">April 2010</a></li><li><a href="/blog/2010/03/">March 2010</a></li><li><a href="/blog/2010/02/">February 2010</a></li><li><a href="/blog/2010/01/">January 2010</a></li></ul><h3>2009</h3><ul><li><a href="/blog/2009/12/">December 2009</a></li><li><a href="/blog/2009/11/">November 2009</a></li><li><a href="/blog/2009/10/">October 2009</a></li><li><a href="/blog/2009/09/">September 2009</a></li><li><a href="/blog/2009/08/">August 2009</a></li><li><a href="/blog/2009/07/">July 2009</a></li><li><a href="/blog/2009/06/">June 2009</a></li><li><a href="/blog/2009/05/">May 2009</a></li><li><a href="/blog/2009/04/">April 2009</a></li><li><a href="/blog/2009/03/">March 2009</a></li><li><a href="/blog/2009/02/">February 2009</a></li><li><a href="/blog/2009/01/">January 2009</a></li></ul><h3>2008</h3><ul><li><a href="/blog/2008/11/">November 2008</a></li><li><a href="/blog/2008/10/">October 2008</a></li><li><a href="/blog/2008/09/">September 2008</a></li><li><a href="/blog/2008/08/">August 2008</a></li></ul></div></aside></article></div></div></div><footer><div class="outer-wrap"><div class="wrap"><div id="copyright"><img alt="Agora Games" src="/assets/images/agora-logo-agga-5548a56c.png"> <a href="http://majorleaguegaming.com" target="_blank"><img alt="Major League Gaming" src="/assets/images/mlg-logo-70241e5b.png"></a><a href="mailto:info@agoragames.com" id="email-us">Email Us</a><p>359 Broadway, Third Floor, Troy, NY 12180</p><p class="dim">&copy; 2013 Agora Games. All Rights Reserved.</p></div></div></div></footer><div class="hide"><iframe id="wufoo-iframe" src="javascript:void(0)"></iframe><a id="wufoo-thanks" href="/thanks/"></a></div><!--[if lt IE 9]>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<![endif]-->
<!--[if gte IE 9]><!-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<!--<![endif]-->
<script>
  if (!window.jQuery) {
    document.write('<script type="text/javascript" src="/assets/javascripts/vendor/jquery.min-199fc76d.js"><' + '/script>');
  }
</script>
<script src="/assets/javascripts/all-2f5d049e.js" type="text/javascript"></script></body></html>