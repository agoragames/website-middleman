<!DOCTYPE html> <html class=no-js lang=en> <head> <meta charset=utf-8> <meta content='width=device-width, initial-scale=1.0' name=viewport> <meta content='IE=edge,chrome=1' http-equiv=X-UA-Compatible> <title>Brain Matters</title> <link href="/assets/stylesheets/app-3b1b68ac.css" rel=stylesheet /> <script src="/assets/javascripts/modernizr-84a49412.js"></script> <link href='/assets/images/agora-a-49573e78.png' rel=icon sizes=128x128 type='image/png'> </head> <body class='blog blog_2009 blog_2009_01 blog_2009_01_index f-topbar-fixed'> <div class='fixed raised'> <nav class=top-bar data-topbar role=navigation> <ul class=title-area> <li class=name> <h1> <a href='/'> <img alt=Agora class="wb-agora main-logo" src="/assets/images/wb-agora-d26616f7.svg"/> </a> </h1> </li> <li class='toggle-topbar menu-icon'> <a href='javascript:void(0)'> <span>Menu</span> </a> </li> </ul> <section class=top-bar-section> <ul class=right> <li> <a data-anchor href='/#about'>About</a> </li> <li> <a data-anchor href='/#team'>Team</a> </li> <li> <a href='/careers'>Careers</a> </li> <li> <a data-anchor href='/#contact'>Contact</a> </li> <li class=hydra-theme> <a href='http://hydra.agoragames.com'> <img alt=Hydra width=92 src="/assets/images/hydra-wordmark-6248cf07.svg"/> </a> </li> </ul> </section> </nav> </div> <div class=row> <div class=columns> <h1 class=blog-page-title> <a href="/blog">The <strong>Blog</strong> </a></h1> </div> </div> <div class=row> <div class='columns large-9'> <div class=blog-page-subtitle> <h2>Posts from January 2009 </h2> </div> <div class=blog-entry-list><div class=blog-entry> <div class=blog__date> Jan 12 </div> <div class=blog__contents> <h2 class=blog__title> <a href="/blog/2009/01/12/porting-legacy-applications-to-modern-systems/">Porting Legacy Applications to Modern Systems</a> </h2> <div class=blog__author> By <strong>Jason LaPorte</strong> </div> <div class=blog__body> <p><em>(Or, an adventure in pain!)</em></p> <p>Let me preface this little article by saying I did <strong>not</strong> write the app I am now porting to our new network. I know noting about its specific intricacies, and furthermore, I know nothing specifically about gettext, file<em>column, or attachment</em>fu. So, I dove into this project with a sort of wanton abandon that is fairly characteristic of much of the work I do. Any obviously stupid mistakes below thus really happened.</p> <p>Let me also preface this with the fact that this Rails app is old. Version 1.2.3 old. So, as always, YMMV.</p> <p>Finally, I really wish attachment_fu had proper documentation.</p> <h2>Installing GetText 1.10.0</h2> <p>We don&rsquo;t really like GetText around here, but, at the time, it was the only option. Getting it running off of a local copy (so I wouldn&rsquo;t have to pollute other projects with it) was less difficult than I expected. Go to your vendor/gems directory and issue: gem unpack gettext This assumes you have gettext 1.10.0 installed locally. I think adding a VERSION=1.10.0 will handle it if you have multiple gettext versions laying around. After that, I merely needed to add the following to config/environment.rb to make sure the gem loaded: GETTEXT<em>GEM</em>DIR = &ldquo;#{File.expand<em>path(RAILS</em>ROOT)}/vendor/gems/gettext-1.10.0&rdquo; $LOAD<em>PATH.reject { |path| path =~ /gettext/ } $LOAD</em>PATH &lt;&lt; GETTEXT<em>GEM</em>DIR $LOAD<em>PATH &lt;&lt; File.join(GETTEXT</em>GEM<em>DIR, &lsquo;lib&rsquo;) $LOAD</em>PATH &lt;&lt; File.join(GETTEXT<em>GEM</em>DIR, &lsquo;ext&rsquo;, &lsquo;gettext&rsquo;) require File.join(GETTEXT<em>GEM</em>DIR, &lsquo;lib&rsquo;, &lsquo;gettext.rb&rsquo;) Ta-da!</p> <h2>Replacing File<em>Column With Attachment</em>Fu</h2> <p>After doing the above and booting up a test server, I get the following fun error: no such file to load &ndash; RMagick There is no way I am ever installing RMagick onto our nice, new, beautiful infrastructure. I want things done right, here. I also don&rsquo;t want to have to be paranoid about memory leaks, especially for legacy applications. So, we have to get rid of it.</p> <p>This problem is caused by our use of file<em>column, an old-but-effective way of easily adding file uploading support into a Rails app. The modern _de facto</em> standard for this seems to be attachment_fu, which uses the much-better-designed ImageScience instead of RMagick.</p> <p>So, let&rsquo;s gut this fish.</p> <h3>Remove File_Column.</h3> <p>$ svn rm vendor/plugins/file_column</p> <h3>Install ImageScience.</h3> <p>$ sudo apt-get -y install libfreeimage3 libfreeimage-dev $ sudo gem install image_science</p> <h3>Install Attachment_Fu.</h3> <p>$ script/plugin install http://svn.techno-weenie.net/projects/plugins/attachment<em>fu/ After installing attachment</em>fu, I powered back up script/server to check the next fun error: undefined method `file<em>column&#39; for Clan:Class This is expected: file</em>column is gone, so the app can&rsquo;t possibly know what a file_column is. Now, we have to get into the nitty-gritty of tweaking the app.</p> <h3>Adapting the Application to Attachment_Fu.</h3> <p>Let&rsquo;s start in app/models/clan.rb, to which I was directed by the aforementioned error: $ grep file<em>column app/models/clan.rb No output. The words file</em>column don&rsquo;t appear in that class. Not what I expected.</p> <p>In the time-honored tradition of killing a cockroach with a shotgun, I then turned my sights on the entire app directory: $ grep -R file<em>column app The only results that turn up happen to be in app/views, leaving me perplexed. A quick conversation with the project lead informs me that this application uses &ldquo;skeletons&rdquo;, or appable</em>plugins, which was an absolutely horrible idea that we thankfully no longer use. In essence, it allows you to wrap pieces of functionality into a self-contained plugin, which is duck-punched onto your application when it starts. It is great from a code-reuse perspective, but horrible from a KISS and maintenance standpoint, which is why we no longer use it.</p> <p>Except that every now and again, it comes back to bite you in the ass when you least expect it.</p> <p>Anyway, checking the skeletons quickly turns up what I am looking for: $ grep -R file<em>column vendor/skeletons/clan</em>skeleton vendor/skeletons/clan<em>skeleton/app/models/clan.rb: file</em>column :avatar_image, :magick =&gt; { :size =&gt; &ldquo;64x64!&rdquo;} So, there is where I have to make the first incision. I changed it as follows:</p> <h1>file<em>column :avatar</em>image, :magick =&gt; { :size =&gt; &ldquo;64x64!&rdquo;}</h1> <p># validates<em>filesize</em>of :avatar_image, :in =&gt; 0..40.kilobytes</p> <p>has<em>attachment :content</em>type =&gt; :image, :storage =&gt; :file<em>system, :max</em>size =&gt; 40.kilobytes, :resize_to =&gt; &lsquo;64x64!&rsquo;</p> <p>validates<em>as</em>attachment Time to restart the server and try again. (I don&rsquo;t honestly expect it to work: there are (at least!) a lot of views that use file_column methods. It is easiest to just hack at them one at a time until everything works, though!)</p> <p>I spent the next couple hours digging through the innards of attachment<em>fu, only to discover that I had written :filesystem, above, instead of :file</em>system (note the underscore). Make sure you spell things correctly, people, or you&rsquo;ll be in for a world of self-induced hurt. (The above snippet shows things the correct way, so you, my beloved internet, won&rsquo;t inadvertently copy-and-paste yourself into hell.)</p> <p>Once I had properly spelled everything, though, I met with success: the front page of the site loaded! Clicking on just about anything yielded a failure, as anticipated: undefined method `url<em>for</em>file<em>column&#39; for #&lt;#<a href="Class:0x7f7d7f3006c0">Class:0x7f7d7f3006c0</a>:0x7f7d7f300670&gt; The views didn&rsquo;t work, but the fix wasn&rsquo;t horrible. Generally speaking, I simply searched and replaced the following: url</em>for<em>file</em>column(X, &lsquo;avatar<em>image&rsquo;) with: X.public</em>filename Also, along with this, I modified the clan table&rsquo;s SQL schema to accomodate attachment<em>fu: ALTER TABLE clans CHANGE avatar</em>image filename VARCHAR(255) DEFAULT NULL; ALTER TABLE clans ADD (content<em>type VARCHAR(255) DEFAULT NULL, size INT DEFAULT NULL, width INT DEFAULT NULL, height INT DEFAULT NULL); Thankfully, this was pretty easy to do, since the clans table was very small for this particular title. If it were larger, I would create a separate table and do a SELECT * FROM clans INSERT INTO clans</em>temp sort of thing. (Yes, I know that it is very evil to hack the SQL directly instead of using migrations. This app is sufficiently old that I cannot guarantee that its migrations even work; I&rsquo;m already spending a lot of time trying to port this app, I don&rsquo;t want to spend much more trying to make it perfect. If it weren&rsquo;t a legacy application, however, I would do things a bit more cleanly.)</p> <p>At this point, virtually everything on the site worked. Avatars (once moved to the proper new directories) showed up just fine. The only remaining error came from trying to upload a new avatar image. Solving this essentially boiled down to a complex series of hacks to blend attachment<em>fu into the remainder of the existing codebase; none of which were particularly complex or interesting (generally involving changing the names a form parameters from the previous :avatar</em>image to the new :uploaded<em>data, like this:) &lt;%#= file</em>column<em>field &lsquo;clan&rsquo;, &lsquo;avatar</em>image&rsquo; %&gt; &lt;%= file<em>field</em>tag :uploaded<em>data %&gt; Doing all this left me with one final application error, received when actually performing the file upload: Content type is not included in the list content type can&rsquo;t be blank Validations are complaining. After tinkering with attachment</em>fu&rsquo;s code for a while, I discover that there is a method that attachment<em>fu adds to your ActiveRecords (uploaded</em>data=), which sets content_type and other miscellaneous variables. And, clearly, this wasn&rsquo;t getting called.</p> <p>Turns out I was getting bitten by multipart forms. By tossing a quick puts params.inspect into the code, I quickly saw where my problem lay. Notice the following bit from our clans controller&rsquo;s update method: @clan.update<em>attributes(params[:clan]) Unfortunately for me, the uploaded data is in params[:uploaded</em>data], and not in params[:clan][:uploaded<em>data]. While there&rsquo;s a cleaner fix, the following hack suits our purposes fine and allows me to finish up this 20-hour hackfest: params[:clan][:uploaded_data] = params[:uploaded</em>data] So, after all of this code mangling, we finally had our app ready to move to a new, lighter-weight infrastructure, ultimately saving us money. A very frustrating few days, but they will pay for themselves. All that remains is integrating into a new infrastructure, and switching over the DNS.</p> </div> </div> </div> <div class=blog-entry> <div class=blog__date> Jan 5 </div> <div class=blog__contents> <h2 class=blog__title> <a href="/blog/2009/01/05/the-misunderstood-art/">The Misunderstood Art</a> </h2> <div class=blog__author> By <strong>Christian Arca</strong> </div> <div class=blog__body> <p><img width=450 height=199 src="/assets/images/uploads/2009/01/blogimage-979e758b.jpg"/></p> <p>Note: This editorial does not express the feelings of Agora Games as a company, and is solely the opinion of the author.</p> <p>Art, by definition is the expression or application of human creative skill and imagination typically in a visual form. A video game by definition is a game played by electronically manipulating images produced by a computer program on a television screen or other display screen. By both definitions of each word, video games may be considered a form of art. The computer program which electronically manipulates images on a display screen must be created by a human. This human, must apply creative skill to create such images as well as the manipulation of images, images being a visual form. The definition of art clearly states that a the expression of human creativity is typically in a visual form, which video games by definition clearly do. Therefore, technically disregarding all personal opinions, culture, and other variable elements video games by definition are art. </p> <p>I strongly believe that video games are a form of art. Video games in fact include almost every single element of art there is. Let us analyze one of the most “accepted” forms of art in society which is included in video games, literature. Many video games these days staff writers to create a story for the particular game at hand. In fact, many game journalists include the quality of story within their review of a game. How much different is that then the <em>New York Times</em> reviewing a new novel? In fact, with games currently averaging about 20+ hours of gameplay it is safe to say that a well developed short story, or even a novel may be included within a video game. </p> <p>While one might argue that the quality of story is rather poor does this not also hold true to several novels? Sure one might say <em>Gears of War</em> had very poor dialogue and a rather poor story progression however, other titles provide players with a very well developed story and dialogue. An example of such a game in my opinion would be <em>Mass Effect,</em> in which a character Lorik Qui’in after you the player say, “I will let you go.” states the following, “Let me go? Do humans consider conversation a form of imprisonment? That would explain why so few of you are willing to sit down and talk&hellip;” This dialogue being directed at my character, therefore an extension of myself since I am controlling the character. The communication is not passive in nature, it is directed at myself and therefore directly impacts my thoughts and feelings on a personal level since it is I who am controlling this character, I who am a living breathing human being. The character being addressed is not print on a paper, it is my character, my choices which insinuated this response from Lorik. </p> <p>This method of immersion can not be achieved through a novel. Koster, touches on this subject by saying, “&hellip;games are very fundamental and powerful learning tools. It’s one thing to read in a book that “the map is not the territory” and another to have your armies rolled over by your opponent in a game. When the latter happens, you’re <em>gonna get the point</em> even if the actual armies aren’t marching into your suburban home.” Furthermore, video games are an accessible medium to any given audience. That is to say, while a certain skill is required to play a video game, both a novice gamer and an experience gamer will both be able to direct their in game experience into the subconscious, intuitive mind. However, in the art of literature, an experienced reader will gain a better experience into their subconscious, intuitive mind rather than a novice reader. </p> <p>Koster, in fact hits on this topic by comparing literature to games. “Consider the key differences between something like a book and different kinds of games. A book can do the logical conscious part of the brain pretty well. And really good readers have an ability to slurp that info directly into the subconscious, intuitive mind. But what a book will never be able to do is accelerate the grokking process to the degree that games do, because you cannot practice a pattern and run permutations on it with a book.” In essence, within a book you do not have the option to experience a scenario or event which you caused and observe the various outcomes of your actions. </p> <p>In addition to providing players with an immersive experience through literature, video games also provide creative visual elements which allow players to continue their immersion in a video game. Furthermore, combining both visual and literary elements provide the player with a unique experience which can not be simulated by any other form of art. Artists, art directors, and creative directors work in unison to give players a certain “feeling” or evoke a certain “emotion” while playing the game. </p> <p>The complexity and infancy of video games make the legitimacy of video games as a medium of art rather difficult to swallow. However, many other forms of art when first introduced went through the same life cycle. From the 1900s to the 1940s on screen films went from short black and white movies to full length hour long movies fully dressed with color and sound. As video games begin to mature and designers, programmers, artists, and musicians begin to become more experienced within this form of art I can only hope that the social stigma and media literacy problem evolves as well. One day I truly believe we will be walking through a museum watching interactive displays featuring some of the greatest forms of art, video games. </p> </div> </div> </div> </div> </div> <div class='columns large-3'> <div class=blog-archives-sidebar> <h2>Blog archives</h2> <h3> <a href="/blog/2015/">2015</a> </h3> <ul> <li> <a href="/blog/2015/10/">October 2015</a> </li> <li> <a href="/blog/2015/03/">March 2015</a> </li> <li> <a href="/blog/2015/01/">January 2015</a> </li> </ul> <h3> <a href="/blog/2014/">2014</a> </h3> <ul> <li> <a href="/blog/2014/12/">December 2014</a> </li> <li> <a href="/blog/2014/11/">November 2014</a> </li> <li> <a href="/blog/2014/10/">October 2014</a> </li> <li> <a href="/blog/2014/08/">August 2014</a> </li> <li> <a href="/blog/2014/07/">July 2014</a> </li> <li> <a href="/blog/2014/06/">June 2014</a> </li> <li> <a href="/blog/2014/04/">April 2014</a> </li> <li> <a href="/blog/2014/03/">March 2014</a> </li> <li> <a href="/blog/2014/02/">February 2014</a> </li> <li> <a href="/blog/2014/01/">January 2014</a> </li> </ul> <h3> <a href="/blog/2013/">2013</a> </h3> <ul> <li> <a href="/blog/2013/11/">November 2013</a> </li> <li> <a href="/blog/2013/10/">October 2013</a> </li> <li> <a href="/blog/2013/09/">September 2013</a> </li> <li> <a href="/blog/2013/08/">August 2013</a> </li> <li> <a href="/blog/2013/07/">July 2013</a> </li> <li> <a href="/blog/2013/06/">June 2013</a> </li> <li> <a href="/blog/2013/05/">May 2013</a> </li> <li> <a href="/blog/2013/04/">April 2013</a> </li> <li> <a href="/blog/2013/03/">March 2013</a> </li> <li> <a href="/blog/2013/02/">February 2013</a> </li> <li> <a href="/blog/2013/01/">January 2013</a> </li> </ul> <h3> <a href="/blog/2012/">2012</a> </h3> <ul> <li> <a href="/blog/2012/12/">December 2012</a> </li> <li> <a href="/blog/2012/11/">November 2012</a> </li> <li> <a href="/blog/2012/10/">October 2012</a> </li> <li> <a href="/blog/2012/09/">September 2012</a> </li> <li> <a href="/blog/2012/08/">August 2012</a> </li> <li> <a href="/blog/2012/07/">July 2012</a> </li> <li> <a href="/blog/2012/06/">June 2012</a> </li> <li> <a href="/blog/2012/05/">May 2012</a> </li> <li> <a href="/blog/2012/04/">April 2012</a> </li> <li> <a href="/blog/2012/03/">March 2012</a> </li> <li> <a href="/blog/2012/02/">February 2012</a> </li> <li> <a href="/blog/2012/01/">January 2012</a> </li> </ul> <h3> <a href="/blog/2011/">2011</a> </h3> <ul> <li> <a href="/blog/2011/10/">October 2011</a> </li> <li> <a href="/blog/2011/09/">September 2011</a> </li> <li> <a href="/blog/2011/08/">August 2011</a> </li> <li> <a href="/blog/2011/07/">July 2011</a> </li> <li> <a href="/blog/2011/06/">June 2011</a> </li> <li> <a href="/blog/2011/05/">May 2011</a> </li> <li> <a href="/blog/2011/04/">April 2011</a> </li> <li> <a href="/blog/2011/03/">March 2011</a> </li> <li> <a href="/blog/2011/02/">February 2011</a> </li> <li> <a href="/blog/2011/01/">January 2011</a> </li> </ul> <h3> <a href="/blog/2010/">2010</a> </h3> <ul> <li> <a href="/blog/2010/12/">December 2010</a> </li> <li> <a href="/blog/2010/11/">November 2010</a> </li> <li> <a href="/blog/2010/10/">October 2010</a> </li> <li> <a href="/blog/2010/09/">September 2010</a> </li> <li> <a href="/blog/2010/08/">August 2010</a> </li> <li> <a href="/blog/2010/07/">July 2010</a> </li> <li> <a href="/blog/2010/06/">June 2010</a> </li> <li> <a href="/blog/2010/05/">May 2010</a> </li> <li> <a href="/blog/2010/04/">April 2010</a> </li> <li> <a href="/blog/2010/03/">March 2010</a> </li> <li> <a href="/blog/2010/02/">February 2010</a> </li> <li> <a href="/blog/2010/01/">January 2010</a> </li> </ul> <h3> <a href="/blog/2009/">2009</a> </h3> <ul> <li> <a href="/blog/2009/12/">December 2009</a> </li> <li> <a href="/blog/2009/11/">November 2009</a> </li> <li> <a href="/blog/2009/10/">October 2009</a> </li> <li> <a href="/blog/2009/09/">September 2009</a> </li> <li> <a href="/blog/2009/08/">August 2009</a> </li> <li> <a href="/blog/2009/07/">July 2009</a> </li> <li> <a href="/blog/2009/06/">June 2009</a> </li> <li> <a href="/blog/2009/05/">May 2009</a> </li> <li> <a href="/blog/2009/04/">April 2009</a> </li> <li> <a href="/blog/2009/03/">March 2009</a> </li> <li> <a href="/blog/2009/02/">February 2009</a> </li> <li> <a href="/blog/2009/01/">January 2009</a> </li> </ul> <h3> <a href="/blog/2008/">2008</a> </h3> <ul> <li> <a href="/blog/2008/11/">November 2008</a> </li> <li> <a href="/blog/2008/10/">October 2008</a> </li> <li> <a href="/blog/2008/09/">September 2008</a> </li> <li> <a href="/blog/2008/08/">August 2008</a> </li> </ul> </div> </div> </div> <script src="/assets/javascripts/app-8d34dc05.js" async=true></script> </body> </html>